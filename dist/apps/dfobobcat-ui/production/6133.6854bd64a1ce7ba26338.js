(self.webpackChunkdfobobcat=self.webpackChunkdfobobcat||[]).push([[6133],{6133:(t,e,n)=>{"use strict";n.r(e),n.d(e,{UiAdminJobsModule:()=>Ze});var o=n(2057),i=n(8535),s=n(4762),c=n(793),a=n(6215),r=n(9765),d=n(4402),l=n(6682),g=n(3342),p=n(4612),h=n(5257),u=n(3738),f=n(4705),b=n(6782),x=n(3190),m=n(6738),Z=n(8229),y=n(739),w=n(4694),v=n(7586),k=n(8002),C=n(3498);const O=function(){return{}};function T(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-select",17),c.NdJ("selected",function(e){return c.CHM(t),c.oxw().builderSelected(e)}),c.qZA()}if(2&t){const t=e.ngIf,n=c.oxw();c.Q6J("control",n.selectedBuilderInput)("multiple",!1)("inputBackground","#fff")("options",t||c.DdM(5,O))("triggerCD",n.triggerCDChildren)}}function M(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-select",18),c.NdJ("selected",function(e){return c.CHM(t),c.oxw().equpmentSelected(e)}),c.qZA()}if(2&t){const t=e.ngIf,n=c.oxw();c.Q6J("control",n.selectedEquipmentInput)("multiple",!0)("inputBackground","#fff")("options",t||c.DdM(5,O))("triggerCD",n.triggerCDChildren)}}function q(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-datepicker",19),c.NdJ("selected",function(e){return c.CHM(t),c.oxw().dateSelected(e)}),c.qZA()}if(2&t){const t=e.ngIf,n=c.oxw();c.Q6J("min",t)("control",n.datetime)}}let _=(()=>{class t{constructor(t,e,n,o,i,s,d,l,g,p){this.fb=t,this.route=e,this.cdRef=n,this.createJobGQL=o,this.updateJobGQL=i,this.jobGQL=s,this.settingsGQL=d,this.equipmentGQL=l,this.router=g,this.usersGQL=p,this.perfectScrollbarConfig={},this.equipment$=new r.xQ,this.builder$=new r.xQ,this.destroy$=new r.xQ,this.ORDER_DIRECTION=v.H,this.minDate$=new Z.t(1),this.selectedDate="",this.selectedEquipment=[],this.selectedBuilder=[],this.selectedCoordinates={lat:void 0,lng:void 0},this.finish=new r.xQ,this.job$=new r.xQ,this.uploadedPO$=new r.xQ,this.orderKeys={"user.name":"Name","user.email":"Email"},this.orderBy$=new a.X("user.name"),this.orderDirection$=new a.X(v.H.DESC),this.triggerCDChildren=new c.vpe,this.form=t.group({datetime:["",[u.kI.required]],selectedEquipmentInput:["",[u.kI.required]],selectedBuilderInput:["",[u.kI.required]],address:["",[u.kI.required]],notes:[""],priority:[""]})}ngOnInit(){(0,y.aj)(this.orderBy$,this.orderDirection$).pipe((0,b.R)(this.destroy$),(0,x.w)(()=>this.getUsers())).subscribe()}ionViewWillEnter(){this.route.params.subscribe(t=>{t.id&&(this.jobId=+t.id),this.jobId&&this.getJob(),this.settingsGQL.fetch().subscribe(t=>{this.minDate$.next(m(t.data.settings.minJobRequestDate))}),this.equipmentGQL.fetch().subscribe(t=>{const e=t.data.equipment.reduce((t,e)=>(t[e.id]=e.name,t),{});this.equipment$.next(e)})})}get datetime(){return this.form.get("datetime")}get selectedEquipmentInput(){return this.form.get("selectedEquipmentInput")}get selectedBuilderInput(){return this.form.get("selectedBuilderInput")}get stage(){return this.form.get("stage")}get address(){return this.form.get("address")}getEquipment(){return this.job$.pipe((0,k.U)(t=>t.equipment?t.equipment.map(t=>t.name).join(", "):""))}dateSelected(t=""){this.selectedDate=t}equpmentSelected(t){this.selectedEquipment=t}builderSelected(t){this.selectedBuilder=t}addressSelected(t){this.selectedCoordinates=t}getJob(){this.jobGQL.fetch({id:this.jobId}).subscribe(t=>{const e=t.data.job;this.job$.next(e),this.uploadedPO$.next(e.poFile?e.poFile:""),this.equpmentSelected(Array.isArray(e.equipment)?e.equipment.filter(t=>!!t.id).map(t=>t.id):[]),this.dateSelected(e.requestDate),this.addressSelected({lat:e.lat,lng:e.lng}),this.form.setValue({address:e.address,datetime:m(e.requestDate).utc().format("MMM D, dddd"),selectedEquipmentInput:e.equipment&&Array.isArray(e.equipment)?e.equipment.map(t=>t.name).join(", "):""})})}getUsers(){return(0,y.aj)(this.orderBy$,this.orderDirection$).pipe((0,h.q)(1),(0,p.b)(([t,e])=>this.usersGQL.fetch({role:"builder",orderBy:`${e}${t}`})),(0,k.U)(t=>t.data.users),(0,g.b)(t=>{const e=t.items.reduce((t,e)=>(t[e.id]=e.name,t),{});this.builder$.next(e)}))}resetForm(){this.form.reset(),Object.keys(this.form.controls).forEach(t=>this.form.controls[t].reset()),this.selectedCoordinates={lat:void 0,lng:void 0},this.selectedEquipment=[],this.selectedBuilder=[],this.selectedDate="",this.addressComponent.cdRef.markForCheck();for(const t of this.selectComponent.optionsControls)t[2].setValue(!1);this.triggerCDChildren.next()}submit(){if(this.form.invalid){for(const t of Object.keys(this.form.controls))this.form.controls[t].markAsDirty();return void this.addressComponent.cdRef.markForCheck()}const t={address:this.form.controls.address.value,equipment:this.selectedEquipment,lng:this.selectedCoordinates.lng,lat:this.selectedCoordinates.lat,requestDate:this.selectedDate,notes:this.form.controls.notes.value,priority:"",type:"created",time:(new Date).toISOString(),adminSelectedBuilder:this.selectedBuilder[0]};this.uploadedPo&&(t.poFile=this.uploadedPo),this.jobId?this.updateJobGQL.mutate({input:Object.assign(Object.assign({},t),{id:this.jobId})},{context:{useMultipart:!0}}).subscribe(()=>{this.finish.next(!0),this.close()}):this.createJobGQL.mutate({input:t},{context:{useMultipart:!0}}).subscribe(()=>{this.finish.next(!0),this.close()})}poUpload(t){this.uploadedPo=t}ionViewWillLeave(){this.resetForm()}close(){this.dismissModal().subscribe()}dismissModal(){return(0,d.D)(this.modal.dismiss())}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(u.qu),c.Y36(i.gz),c.Y36(c.sBO),c.Y36(f.Kg),c.Y36(f.hh),c.Y36(f.Gp),c.Y36(f.QO),c.Y36(f.L_),c.Y36(i.F0),c.Y36(f.lY))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-create-jobs-dialog-dialog"]],viewQuery:function(t,e){if(1&t&&(c.Gf(w.QQ,5),c.Gf(w.Hr,5)),2&t){let t;c.iGM(t=c.CRH())&&(e.addressComponent=t.first),c.iGM(t=c.CRH())&&(e.selectComponent=t.first)}},inputs:{modal:"modal"},decls:29,vars:16,consts:[[1,"ion-no-border"],["slot","start"],["src","/assets/icon/back-round.svg",3,"click"],["slot","end",1,"profile-title"],[1,"page-wrapper"],[3,"formGroup","submit"],["style","z-index: 35;","placeholder","Select builder","theme","dark","label","Select Builder",3,"control","multiple","inputBackground","options","triggerCD","selected",4,"ngIf"],["style","z-index: 30;","placeholder","Select stage","theme","dark","label","Type of building equipment",3,"control","multiple","inputBackground","options","triggerCD","selected",4,"ngIf"],["ngDefaultControl","",3,"formControl","selected"],["style","z-index:25;","placeholder","Select a date",3,"min","control","selected",4,"ngIf"],[1,"attach-po-input"],[3,"fileName","upload"],[1,"notes",2,"z-index","20"],["placeholder","Write a note","theme","dark","label","Notes",3,"control"],[2,"flex","1 0 auto"],["type","submit","expand","block","size","large","shape","round"],["slot","start","src","/assets/icon/truck.svg"],["placeholder","Select builder","theme","dark","label","Select Builder",2,"z-index","35",3,"control","multiple","inputBackground","options","triggerCD","selected"],["placeholder","Select stage","theme","dark","label","Type of building equipment",2,"z-index","30",3,"control","multiple","inputBackground","options","triggerCD","selected"],["placeholder","Select a date",2,"z-index","25",3,"min","control","selected"]],template:function(t,e){if(1&t&&(c.TgZ(0,"ion-header",0),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"div",1),c.TgZ(3,"ion-icon",2),c.NdJ("click",function(){return e.close()}),c.qZA(),c.qZA(),c.TgZ(4,"div",3),c.TgZ(5,"span"),c._uU(6,"Create Job"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(7,"ion-content"),c.TgZ(8,"div",4),c.TgZ(9,"h1"),c._uU(10,"Submit request"),c.qZA(),c.TgZ(11,"form",5),c.NdJ("submit",function(){return e.submit()}),c.YNc(12,T,1,6,"bc-select",6),c.ALo(13,"async"),c.YNc(14,M,1,6,"bc-select",7),c.ALo(15,"async"),c.TgZ(16,"bc-address-input",8),c.NdJ("selected",function(t){return e.addressSelected(t)}),c.qZA(),c.YNc(17,q,1,2,"bc-datepicker",9),c.ALo(18,"async"),c.TgZ(19,"div",10),c.TgZ(20,"bc-file-upload",11),c.NdJ("upload",function(t){return e.poUpload(t)}),c.ALo(21,"async"),c.qZA(),c.qZA(),c.TgZ(22,"div",12),c._UZ(23,"bc-input",13),c.qZA(),c._UZ(24,"div",14),c.TgZ(25,"ion-button",15),c._UZ(26,"ion-icon",16),c.TgZ(27,"span"),c._uU(28),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t){let t;c.xp6(11),c.Q6J("formGroup",e.form),c.xp6(1),c.Q6J("ngIf",c.lcZ(13,8,e.builder$)),c.xp6(2),c.Q6J("ngIf",c.lcZ(15,10,e.equipment$)),c.xp6(2),c.Q6J("formControl",e.address),c.xp6(1),c.Q6J("ngIf",c.lcZ(18,12,e.minDate$)),c.xp6(3),c.Q6J("fileName",null!==(t=c.lcZ(21,14,e.uploadedPO$))&&void 0!==t?t:""),c.xp6(3),c.Q6J("control",e.form.controls.notes),c.xp6(5),c.Oqu(e.jobId?"edit":"submit")}},directives:[C.Gu,C.sr,C.gu,C.W2,u._Y,u.JL,u.sg,o.O5,w.QQ,u.Fj,u.JJ,u.oH,w.Yr,w.am,C.YG,w.Hr,w.QB],pipes:[o.Ov],styles:["bc-address-input[_ngcontent-%COMP%], bc-input[_ngcontent-%COMP%], bc-select[_ngcontent-%COMP%]{margin-bottom:36px;display:block}bc-file-upload[_ngcontent-%COMP%]{display:block;margin-top:24px}form[_ngcontent-%COMP%]{display:flex;flex-flow:column}.page-wrapper[_ngcontent-%COMP%], form[_ngcontent-%COMP%]{height:100%}ion-item[_ngcontent-%COMP%]{--inner-padding-end:40px}.notes[_ngcontent-%COMP%]{margin-top:34px}"],changeDetection:0}),t})();var A=n(7422),D=n(7472),j=n(2414),P=n(4689);let J=(()=>{class t extends o.uU{constructor(t){super(t)}transform(t,e){return super.transform(t,e,"+0000","en-US")||""}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(c.soG,16))},t.\u0275pipe=c.Yjl({name:"bcDate",type:t,pure:!0}),t})();function $(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-icon",9),c.NdJ("click",function(){return c.CHM(t),c.oxw().hidden=!0}),c.qZA()}}function I(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-icon",10),c.NdJ("click",function(){return c.CHM(t),c.oxw().hidden=!1}),c.qZA()}}function N(t,e){if(1&t&&(c.TgZ(0,"div",17),c._uU(1),c.qZA()),2&t){const t=c.oxw(2);c.xp6(1),c.hij(" ",t.clockOff.notes," ")}}function Q(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"img",22),c.NdJ("click",function(e){return c.CHM(t),c.oxw(3).openImage(e)}),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw(3);c.Q6J("src",n.clockOffImageBase+"/"+t,c.LSH)}}function U(t,e){if(1&t&&(c.ynx(0),c.YNc(1,Q,1,1,"img",21),c.BQk()),2&t){const t=c.oxw(2);c.xp6(1),c.Q6J("ngForOf",t.clockOff.images)}}function Y(t,e){if(1&t&&(c.TgZ(0,"div",11),c.TgZ(1,"div",12),c._UZ(2,"ion-icon",13),c._UZ(3,"div",14),c.qZA(),c.TgZ(4,"div",15),c.TgZ(5,"div",16),c._uU(6),c.ALo(7,"bcDate"),c.qZA(),c.TgZ(8,"div",17),c._uU(9),c.ALo(10,"bcDate"),c.qZA(),c.YNc(11,N,2,1,"div",18),c.TgZ(12,"div",19),c.YNc(13,U,2,1,"ng-container",20),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(6),c.hij(" ",c.xi3(7,4,t.clockOff.clockOffTime||t.clockOff.clockInTime,"MMMM d, EEEE")," "),c.xp6(3),c.hij(" ",c.xi3(10,7,t.clockOff.clockOffTime||t.clockOff.clockInTime,"hh:mm a")," "),c.xp6(2),c.Q6J("ngIf",(null==t.clockOff?null:t.clockOff.notes)&&""!=t.clockOff.notes),c.xp6(2),c.Q6J("ngIf",t.clockOff.images&&t.clockOff.images.length)}}let F=(()=>{class t{constructor(t){this.config=t,this.hidden=!1,this.clockOff={},this.type="clockOff"}ngOnInit(){const t="clockIn"===this.type?"clock-in":"clock-off";this.clockOffImageBase=`${this.config.get("beUrl")}/${t}/${this.clockOff.id}`}openImage(t){const e=t.target;e.style.display="block",e.style.width="200px",e.style.height="200px";const n=e.getAttribute("src");window.open(n,"Image","width=image.stylewidth,height=image.style.height,resizable=1")}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(A.E4))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-clockoff-card"]],hostVars:2,hostBindings:function(t,e){2&t&&c.ekj("hidden",e.hidden)},inputs:{clockOff:"clockOff",type:"type"},decls:10,vars:5,consts:[[1,"clockoff-card"],[1,"staff-info"],[1,"staff-icon"],["src","/assets/icon/staff.svg"],[1,"name"],[2,"flex","1 0 auto"],["name","caret-down-outline",3,"click",4,"ngIf"],["name","caret-up-outline",3,"click",4,"ngIf"],["class","clock-off-info",4,"ngIf"],["name","caret-down-outline",3,"click"],["name","caret-up-outline",3,"click"],[1,"clock-off-info"],[1,"time-col"],["src","/assets/icon/calendar-light.svg"],[1,"line"],[1,"content-col"],[1,"date"],[1,"time"],["class","time",4,"ngIf"],[1,"images"],[4,"ngIf"],["width","176","height","176","alt","",3,"src","click",4,"ngFor","ngForOf"],["width","176","height","176","alt","",3,"src","click"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c._UZ(3,"ion-icon",3),c.qZA(),c.TgZ(4,"span",4),c._uU(5),c.qZA(),c._UZ(6,"div",5),c.YNc(7,$,1,0,"ion-icon",6),c.YNc(8,I,1,0,"ion-icon",7),c.qZA(),c.YNc(9,Y,14,10,"div",8),c.qZA()),2&t&&(c.xp6(5),c.AsE("",e.clockOff.staff.name," ","clockIn"===e.type?" clocked in":"clocked off",""),c.xp6(2),c.Q6J("ngIf",!e.hidden),c.xp6(1),c.Q6J("ngIf",e.hidden),c.xp6(1),c.Q6J("ngIf",!e.hidden))},directives:[C.gu,o.O5,o.sg],pipes:[J],styles:['.staff-info[_ngcontent-%COMP%]{background-color:#185963;padding:8px 48px;display:flex;flex-flow:row nowrap;align-items:center;margin-bottom:4px}.staff-info[_ngcontent-%COMP%]   .staff-icon[_ngcontent-%COMP%]{margin-right:8px;width:48px;height:48px;border-radius:50%;background-color:#cfd8dc;display:flex;align-items:center;justify-content:center}.staff-info[_ngcontent-%COMP%]   .staff-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#cfd8dc}.clock-off-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:24px auto;grid-row-gap:0;row-gap:0;grid-column-gap:0;column-gap:0;align-items:stretch;padding:12px 48px;background-color:#185963}.clock-off-info[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:178px;height:178px;object-fit:cover;object-position:center;border-radius:8px}.clock-off-info[_ngcontent-%COMP%]   .time-col[_ngcontent-%COMP%]{width:24px;display:flex;flex-flow:column nowrap;align-items:center;justify-content:stretch;height:100%}.clock-off-info[_ngcontent-%COMP%]   .time-col[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{width:1px;background-color:#fff;height:100%}.clock-off-info[_ngcontent-%COMP%]   .time-col[_ngcontent-%COMP%]:after{display:block;content:" ";width:5px;height:5px;background-color:#fff}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-weight:700;padding-left:10px}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], .clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{margin-bottom:8px}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{margin-left:-12px;display:flex;flex-flow:row nowrap;justify-content:flex-start;align-items:center}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]:before{width:20px;height:1px;background-color:#fff;content:" "}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{padding-left:10px;display:flex;flex-flow:row wrap}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:16px}.clock-off-info[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:last-of-type{margin-right:0}'],changeDetection:0}),t})();function S(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-input",16),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(3).saveNoteInput(e)}),c.qZA(),c.qZA()}}function R(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",17),c.NdJ("click",function(){return c.CHM(t),c.oxw(3).showNoteField()}),c._uU(1,"Add note"),c.qZA()}}function E(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-button",17),c.NdJ("click",function(){return c.CHM(t),c.oxw(3).addNote()}),c._uU(1,"Save note"),c.qZA()}}function L(t,e){if(1&t&&(c.TgZ(0,"div",18),c.TgZ(1,"span",19),c._uU(2,"Notes: "),c.qZA(),c.TgZ(3,"span",20),c._uU(4),c.qZA(),c.qZA()),2&t){const t=c.oxw(3);c.xp6(4),c.Oqu(t.notes)}}function B(t,e){if(1&t&&(c.TgZ(0,"span",20),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.hij("",t,", ")}}function H(t,e){if(1&t&&(c.TgZ(0,"div",18),c.TgZ(1,"span",19),c._uU(2,"Assigned To: "),c.qZA(),c.YNc(3,B,2,1,"span",21),c.qZA()),2&t){const t=c.oxw(3);c.xp6(3),c.Q6J("ngForOf",t.assignedStaff)}}function G(t,e){1&t&&c._UZ(0,"bc-clockoff-card",22),2&t&&c.Q6J("clockOff",e.$implicit)}function z(t,e){1&t&&c._UZ(0,"bc-clockoff-card",23),2&t&&c.Q6J("clockOff",e.$implicit)}function W(t,e){if(1&t&&(c.TgZ(0,"ion-item",24),c.TgZ(1,"ion-title",25),c._uU(2),c.qZA(),c.TgZ(3,"div",26),c._uU(4),c.ALo(5,"date"),c.qZA(),c.qZA()),2&t){const t=e.$implicit;c.xp6(2),c.hij(" ",t.type.toUpperCase()," "),c.xp6(2),c.hij(" ",c.xi3(5,2,t.date,"medium")," ")}}function X(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-datepicker-button",27),c.NdJ("updated",function(e){return c.CHM(t),c.oxw(3).updateJobDate(e)})("canceled",function(){return c.CHM(t),c.oxw(3).cancleUpdate()}),c.qZA()}if(2&t){const t=e.ngIf,n=c.oxw(3);c.Q6J("min",t)("jobData",n.jobData)}}function V(t,e){if(1&t){const t=c.EpF();c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"span"),c._uU(4,"Job history"),c.qZA(),c._UZ(5,"div",3),c.YNc(6,S,2,0,"div",0),c.YNc(7,R,2,0,"ion-button",4),c.YNc(8,E,2,0,"ion-button",4),c.TgZ(9,"ion-button",5),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).cancelJob()}),c._uU(10,"Delete"),c.qZA(),c.TgZ(11,"ion-button",6),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).unassign()}),c._uU(12,"Unassign"),c.qZA(),c.TgZ(13,"ion-button",5),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).openDatePicker()}),c._uU(14,"Edit Date"),c.qZA(),c.TgZ(15,"ion-button",7),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).printReport()}),c._uU(16,"Print"),c.qZA(),c.TgZ(17,"ion-icon",8),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).close.next()}),c.qZA(),c.qZA(),c.TgZ(18,"div",9),c.TgZ(19,"div",10),c.TgZ(20,"div"),c._uU(21),c.qZA(),c.YNc(22,L,5,1,"div",11),c.YNc(23,H,4,1,"div",11),c.qZA(),c.YNc(24,G,1,1,"bc-clockoff-card",12),c.YNc(25,z,1,1,"bc-clockoff-card",13),c.YNc(26,W,6,5,"ion-item",14),c.YNc(27,X,1,2,"bc-datepicker-button",15),c.ALo(28,"async"),c.qZA(),c.qZA(),c.BQk()}if(2&t){const t=c.oxw().ngIf,e=c.oxw();c.xp6(6),c.Q6J("ngIf",e.showNote),c.xp6(1),c.Q6J("ngIf",!e.showNote),c.xp6(1),c.Q6J("ngIf",e.showNote),c.xp6(13),c.Oqu(e.dialogData.job.address),c.xp6(1),c.Q6J("ngIf",""!==e.notes),c.xp6(1),c.Q6J("ngIf",e.assignedStaff.length>0),c.xp6(1),c.Q6J("ngForOf",t.clockIns),c.xp6(1),c.Q6J("ngForOf",t.clockOffs),c.xp6(1),c.Q6J("ngForOf",e.dialogData.job.activity),c.xp6(1),c.Q6J("ngIf",c.lcZ(28,10,e.minDate$))}}function K(t,e){if(1&t&&(c.ynx(0),c.YNc(1,V,29,12,"ng-container",0),c.BQk()),2&t){const t=e.ngIf;c.xp6(1),c.Q6J("ngIf",t.clockIns&&t.clockOffs)}}const tt=function(t,e){return{clockOffs:t,clockIns:e}};let et=(()=>{class t{constructor(t,e,n,o,i,s,c,d,l,g){this.clockOffsGQL=t,this.clockInsGQL=e,this.settingsGQL=n,this.modalController=o,this.updateJobDateGQL=i,this.dialogData=s,this.assignToJobGQL=c,this.updateJobGQL=d,this.cancelJobGQL=l,this.jobStaffGQL=g,this.close=new r.xQ,this.unassigned=new r.xQ,this.updateRequestDate=new r.xQ,this.$clockOffs=new a.X([]),this.$clockIns=new a.X([]),this.assigner="",this.notes="",this.minDate$=new Z.t(1),this.selectedDate="",this.showDatePicker=!1,this.assignedStaff=[],this.showNote=!1,this.extraNote=""}ngOnInit(){this.getClockOffs(),this.getClockIns(),this.getAssignedStaff(),this.jobData=this.dialogData,console.log(this.jobData),this.notes=this.jobData.job.notes,this.settingsGQL.fetch().subscribe(t=>{this.minDate$.next(m(t.data.settings.minJobRequestDate))})}saveNoteInput(t){this.extraNote=t.detail.value}showNoteField(){return(0,s.mG)(this,void 0,void 0,function*(){this.showNote=!0})}cancelJob(){console.log(this.jobData.job.id),this.cancelJobGQL.mutate({input:parseFloat(this.jobData.job.id)}).subscribe(()=>this.close.next())}addNote(){var t;let e="";console.log(this.jobData);const n=this.jobData.job;e=n.notes?n.notes+" | "+this.extraNote:this.extraNote;const o=n.id,i={address:n.address,equipment:null===(t=n.equipment)||void 0===t?void 0:t.map(t=>t.id),lng:n.lng,lat:n.lat,requestDate:n.requestDate,notes:e,priority:n.priority?void 0:""};this.showNote=!1,this.notes=e,this.updateJobGQL.mutate({input:Object.assign(Object.assign({},i),{id:o})},{context:{useMultipart:!0}}).subscribe(t=>{this.updateRequestDate.next(!0)})}getAssignedStaff(){this.jobStaffGQL.fetch({id:this.dialogData.job.id}).subscribe(t=>{this.assignedStaff=t.data.job.staff.map(t=>t.name)})}printReport(){var t;const e=this.jobData.job;null===(t=document.getElementById("printable"))||void 0===t||t.innerHTML.toString();var n=window.open("","PRINT","height=400,width=600");null==n||n.document.write("<html><head><title>DFOBOBCAT - Job history</title>"),null==n||n.document.write("<style>* {font-family: sans-serif;}</style>"),null==n||n.document.write("</head><body style = 'border: 2px solid black;padding:10px;'>"),null==n||n.document.write("<h1 style = 'text-align:center;padding:10px;border-bottom:2px solid black;'>JOB HISTORY</h1>"),null==n||n.document.write("<div style = 'font-size:22px;font-weight:bold;'>"+e.address+"</div>"),""!=e.notes&&(null==n||n.document.write("<div style = 'font-size:16px;font-weight:300;'>Notes: "+e.notes+"</div>")),null==n||n.document.write("<div style = 'text-align:center;margin-top:50px;font-weight:bold;font-size:20px;'>Clocks Off</div>"),null==n||n.document.write("<table style = 'width:100%;border:1px solid black;'>"),this.$clockOffs.forEach(t=>{t.forEach(t=>{null==n||n.document.write("<tr><th style = 'border:1px solid black;'><div style = 'float:left'>"+t.staff.name+"</div></th>"),null==n||n.document.write("<th style = 'border:1px solid black;'><div style = 'float:right'>"+new Date(Number(t.clockOffTime)).toUTCString()+"</div></th></tr>")}),null==n||n.document.write("</table>"),null==n||n.document.write("<div style = 'text-align:center;margin-top:50px;font-weight:bold;font-size:20px;'>Activity</div>"),null==n||n.document.write("<table style = 'width:100%;border:1px solid black;'>");for(let e of this.dialogData.job.activity)null==n||n.document.write("<tr><th style = 'border:1px solid black;'><div style = 'float:left'>"+e.type+"</div></th>"),null==n||n.document.write("<th style = 'border:1px solid black;'><div style = 'float:right'>"+new Date(e.date).toLocaleString()+"</div></th></tr>");return null==n||n.document.write("</table>"),null==n||n.document.write("</body></html>"),null==n||n.document.close(),null==n||n.focus(),null==n||n.print(),null==n||n.close(),!0})}getClockOffs(){this.clockOffsGQL.fetch({id:this.dialogData.job.id}).subscribe(t=>{this.$clockOffs.next(t.data.job.clockOffs)})}getClockIns(){this.clockInsGQL.fetch({id:this.dialogData.job.id}).subscribe(t=>{this.$clockIns.next(t.data.job.clockIns)})}unassign(){this.assignToJobGQL.mutate({input:{jobId:this.dialogData.job.id,staffIds:[]}}).subscribe(()=>{this.unassigned.next(!0),this.close.next()})}dateSelected(t=""){this.selectedDate=t}openDatePicker(){this.showDatePicker=!this.showDatePicker,this.showDatePicker?this.datePickerButton.openDatepicker():this.datePickerButton.closeDatepicker()}updateJobDate(t=""){this.updateJobDateGQL.mutate({input:{requestDate:t,updateField:"requestDate",id:this.dialogData.job.id}}).subscribe(()=>{this.close.next(),this.updateRequestDate.next(!0),this.showDatePicker=!1})}cancleUpdate(){this.showDatePicker=!1}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.Pw),c.Y36(f.vH),c.Y36(f.QO),c.Y36(C.IN),c.Y36(f.su),c.Y36(P.dR),c.Y36(f.F2),c.Y36(f.hh),c.Y36(f.mm),c.Y36(f.ZH))},t.\u0275cmp=c.Xpm({type:t,selectors:[["dfobobcat-clockoff-dialog"]],viewQuery:function(t,e){if(1&t&&c.Gf(w.bg,5),2&t){let t;c.iGM(t=c.CRH())&&(e.datePickerButton=t.first)}},decls:3,vars:8,consts:[[4,"ngIf"],["id","printable",1,"dialog-container"],[1,"dialog-header"],[2,"flex","1 0 auto"],["color","warning",3,"click",4,"ngIf"],["color","danger",3,"click"],[1,"btn-unassign",3,"click"],["color","success",3,"click"],["src","/assets/icon/close.svg",3,"click"],[1,"dialog-body"],[1,"address"],["style","font-size: 14px",4,"ngIf"],["type","clockIn",3,"clockOff",4,"ngFor","ngForOf"],["type","clockOff",3,"clockOff",4,"ngFor","ngForOf"],["lines","none","color","none","style","background: rgba(255, 255, 255, 0.212)",4,"ngFor","ngForOf"],["style","z-index: 25",3,"min","jobData","updated","canceled",4,"ngIf"],["placeholder","Enter note here",3,"ionChange"],["color","warning",3,"click"],[2,"font-size","14px"],[2,"font-weight","700"],[2,"font-weight","300"],["style","font-weight: 300",4,"ngFor","ngForOf"],["type","clockIn",3,"clockOff"],["type","clockOff",3,"clockOff"],["lines","none","color","none",2,"background","rgba(255, 255, 255, 0.212)"],["slot","start",2,"color","white"],["slot","end",2,"color","rgba(255, 255, 255, 0.712)"],[2,"z-index","25",3,"min","jobData","updated","canceled"]],template:function(t,e){1&t&&(c.YNc(0,K,2,1,"ng-container",0),c.ALo(1,"async"),c.ALo(2,"async")),2&t&&c.Q6J("ngIf",c.WLB(5,tt,c.lcZ(1,1,e.$clockOffs),c.lcZ(2,3,e.$clockIns)))},directives:[o.O5,C.YG,C.gu,o.sg,C.pK,C.j9,F,C.Ie,C.wd,w.bg],pipes:[o.Ov,o.uU],styles:[".dialog-body[_ngcontent-%COMP%]{position:relative;width:1104px}.dialog-body[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{font-size:20px;line-height:24px;margin-bottom:29px}.dialog-container[_ngcontent-%COMP%]{min-height:500px;border-radius:8px;color:#fff;background-color:#004853;padding:28px 0}.dialog-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;border-bottom:1px solid #78909c;padding:0 16px 16px 48px;margin-bottom:16px}.dialog-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#78909c;font-size:16px;line-height:22px}.dialog-header[_ngcontent-%COMP%]   .btn-unassign[_ngcontent-%COMP%]{--border-color:blue;--background:blue;--color:#fff}.address[_ngcontent-%COMP%]{padding:0 48px}bc-clockoff-card[_ngcontent-%COMP%]:not(:last-child){margin-bottom:16px;display:block}.dialog-container[_ngcontent-%COMP%]{max-height:900px;overflow:auto}"],changeDetection:0}),t})();function nt(t,e){if(1&t&&(c.TgZ(0,"li"),c._UZ(1,"bc-checkbox",9),c.TgZ(2,"span",10),c._uU(3),c.qZA(),c.qZA()),2&t){const t=e.$implicit,n=c.oxw(2);c.xp6(1),c.Q6J("label",t.name)("formControl",n.assignTo[t.id]),c.xp6(2),c.Oqu(t.role.name)}}function ot(t,e){if(1&t&&(c.TgZ(0,"ul"),c.YNc(1,nt,4,3,"li",8),c.qZA()),2&t){const t=e.ngIf;c.xp6(1),c.Q6J("ngForOf",t)}}let it=(()=>{class t{constructor(t,e,n){this.usersGQL=t,this.assignToJobGQL=e,this.dialogData=n,this.close=new r.xQ,this.staff$=new a.X([]),this.assignTo={}}ngOnInit(){this.getStaff()}getStaff(){this.usersGQL.fetch({role:"staff"}).subscribe(t=>{const e=t.data.users.items;for(const n of e)this.assignTo[n.id]=new u.NI(!1);this.staff$.next(e)})}assignStaff(){const t=Object.keys(this.assignTo).filter(t=>this.assignTo[+t].value).map(t=>+t);this.assignToJobGQL.mutate({input:{jobId:this.dialogData.jobId,staffIds:t}}).subscribe(()=>{this.close.next(!0)})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.lY),c.Y36(f.F2),c.Y36(P.CR))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-assign-job-dialog"]],inputs:{jobId:"jobId"},decls:13,vars:3,consts:[[1,"dialog-container"],[1,"dialog-header"],[2,"flex","1 0 auto"],["src","/assets/icon/close.svg",3,"click"],[1,"dialog-body"],[4,"ngIf"],[1,"dialog-buttons"],["type","button","shape","round",1,"assign",3,"click"],[4,"ngFor","ngForOf"],["padding","0","theme","light","ngDefaultControl","",3,"label","formControl"],[1,"role"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"span"),c._uU(3,"Assign Work"),c.qZA(),c._UZ(4,"div",2),c.TgZ(5,"ion-icon",3),c.NdJ("click",function(){return e.close.next(!1)}),c.qZA(),c.qZA(),c.TgZ(6,"div",4),c.YNc(7,ot,2,1,"ul",5),c.ALo(8,"async"),c.qZA(),c.TgZ(9,"div",6),c.TgZ(10,"ion-button",7),c.NdJ("click",function(){return e.assignStaff()}),c.TgZ(11,"span"),c._uU(12,"assign"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(7),c.Q6J("ngIf",c.lcZ(8,1,e.staff$)))},directives:[C.gu,o.O5,C.YG,o.sg,w.bK,u.Fj,u.JJ,u.oH],pipes:[o.Ov],styles:[".dialog-container[_ngcontent-%COMP%]{display:block;min-height:150px;width:327px;background-color:#004853;color:#fff;padding:16px;position:relative;border-radius:0 0 8px 8px}.dialog-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style-type:none;overflow:auto;max-height:230px}.dialog-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;margin-bottom:24px;align-items:center}.dialog-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1 1 auto}.dialog-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;border-bottom:1px solid #78909c;padding-bottom:15px}.dialog-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#78909c}.dialog-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.assign[_ngcontent-%COMP%]{width:13em;height:2em;font-size:11px;text-transform:uppercase;--color:#004853;--border-width:0;--background:#e8f54a;--background-activated:#cfd8dc;--background-focused:#cfd8dc}bc-checkbox[_ngcontent-%COMP%]{width:192px}"],changeDetection:0}),t})();var st=n(6610),ct=n(7519);const at=["jobCard"];function rt(t,e){if(1&t&&(c.TgZ(0,"div",3),c.TgZ(1,"div",9),c._uU(2),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Oqu(t.job.builder.name)}}function dt(t,e){if(1&t&&(c.TgZ(0,"div",3),c.TgZ(1,"div",5),c._uU(2),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Oqu(t.job.notes)}}let lt=(()=>{class t{constructor(t,e){this.overlay=t,this.injector=e,this.update=new c.vpe,this.destroy$=new r.xQ}get equipment(){return Array.isArray(this.job.equipment)?this.job.equipment.map(t=>t.name).join(", "):[]}get date(){return m(this.job.requestDate).utc().format("MMM D, dddd")}showModal(){const t=this.overlay.position().flexibleConnectedTo(this.cardContentRef).withPositions([new D.tR({originX:"center",originY:"top"},{overlayX:"center",overlayY:"top"})]),e=this.overlay.scrollStrategies.close();this.dialogRef=this.overlay.create(new D.X_({disposeOnNavigation:!0,scrollStrategy:e,positionStrategy:t,hasBackdrop:!1,panelClass:"bc-dialog",backdropClass:"bc-dialog-backdrop",height:327}));const n=new j.C5(it,null,this.createInjector({jobId:this.job.id})),o=this.dialogRef.attach(n);(0,l.T)(this.destroy$,o.instance.close.pipe((0,h.q)(1))).subscribe(t=>{this.dialogRef.dispose(),t&&this.update.next()})}showClockOffModal(){const t=this.overlay.position().global().centerHorizontally().centerVertically(),e=this.overlay.scrollStrategies.close();this.dialogRef=this.overlay.create(new D.X_({disposeOnNavigation:!0,scrollStrategy:e,positionStrategy:t,hasBackdrop:!1,panelClass:"bc-dialog",backdropClass:"bc-dialog-backdrop"}));const n=new j.C5(et,null,this.createInjector1({job:this.job})),o=this.dialogRef.attach(n);(0,l.T)(this.destroy$,o.instance.unassigned.pipe((0,h.q)(1))).subscribe(t=>{this.dialogRef.dispose(),t&&this.update.next()}),(0,l.T)(this.destroy$,o.instance.updateRequestDate.pipe((0,h.q)(1))).subscribe(t=>{this.dialogRef.dispose(),t&&this.update.next()}),o.instance.close.pipe((0,h.q)(1)).subscribe(()=>{this.dialogRef.dispose()})}createInjector(t){const e=new WeakMap([[P.CR,t]]);return new j.nK(this.injector,e)}createInjector1(t){const e=new WeakMap([[P.dR,t]]);return new j.nK(this.injector,e)}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(D.aV),c.Y36(c.zs3))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-job-unassigned"]],viewQuery:function(t,e){if(1&t&&c.Gf(at,5,c.SBq),2&t){let t;c.iGM(t=c.CRH())&&(e.cardContentRef=t.first)}},inputs:{job:"job"},outputs:{update:"update"},decls:22,vars:10,consts:[[1,"job-card-wrapper"],[1,"job-card"],["class","job-card-line",4,"ngIf"],[1,"job-card-line"],[3,"src"],[1,"job-card-desc"],[1,"job-assign"],["jobCard",""],[1,"assign-icon",3,"click"],[2,"font-weight","bold","text-align","center"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.YNc(2,rt,3,1,"div",2),c.TgZ(3,"div",3),c._UZ(4,"ion-icon",4),c.TgZ(5,"div",5),c._uU(6),c.qZA(),c.qZA(),c.TgZ(7,"div",3),c._UZ(8,"ion-icon",4),c.TgZ(9,"div",5),c._uU(10),c.qZA(),c.qZA(),c.TgZ(11,"div",3),c._UZ(12,"ion-icon",4),c.TgZ(13,"div",5),c._uU(14),c.qZA(),c.qZA(),c.YNc(15,dt,3,1,"div",2),c.qZA(),c.TgZ(16,"div",6,7),c.TgZ(18,"div",8),c.NdJ("click",function(){return e.showModal()}),c._UZ(19,"ion-icon",4),c.qZA(),c.TgZ(20,"div",8),c.NdJ("click",function(){return e.showClockOffModal()}),c._UZ(21,"ion-icon",4),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(2),c.Q6J("ngIf",null==e.job||null==e.job.builder?null:e.job.builder.name),c.xp6(2),c.Q6J("src","/assets/icon/truck-disabled.svg"),c.xp6(2),c.Oqu(e.equipment),c.xp6(2),c.Q6J("src","/assets/icon/location-disabled.svg"),c.xp6(2),c.Oqu(e.job.address),c.xp6(2),c.Q6J("src","/assets/icon/calendar-disabled.svg"),c.xp6(2),c.Oqu(e.date),c.xp6(1),c.Q6J("ngIf",e.job.notes),c.xp6(4),c.Q6J("src","/assets/icon/assign.svg"),c.xp6(2),c.Q6J("src","/assets/icon/goto.svg"))},directives:[o.O5,C.gu],styles:[".job-assign[_ngcontent-%COMP%]{padding:4px 6px;display:flex;flex-flow:row nowrap;background-color:#78909c;justify-content:flex-end;border-radius:0 0 8px 8px}.job-assign[_ngcontent-%COMP%]   .assign-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:4px}.job-assign[_ngcontent-%COMP%]   .assign-icon[_ngcontent-%COMP%]:hover{background-color:rgba(232,245,74,.6)}.job-assign[_ngcontent-%COMP%]   .assign-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{height:24px;width:24px}.job-card[_ngcontent-%COMP%]{position:relative;background-color:#f6f8fa;border:1px solid #78909c;border-bottom:0;border-radius:8px 8px 0 0}.job-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:24px;height:24px}.job-card[_ngcontent-%COMP%]   .job-card-line[_ngcontent-%COMP%]{padding:16px;display:flex;flex-flow:row nowrap;border-bottom:1px solid #78909c}.job-card[_ngcontent-%COMP%]   .job-card-line[_ngcontent-%COMP%]:last-of-type{border-bottom-width:0}.job-card[_ngcontent-%COMP%]   .job-card-line[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:first-of-type{margin-right:13px}.job-card[_ngcontent-%COMP%]   .job-card-desc[_ngcontent-%COMP%]{flex:0 1 auto;text-overflow:ellipsis;font-size:16px;line-height:22px;overflow:hidden;white-space:nowrap;width:16rem;padding-right:8px}[_nghost-%COMP%]{width:327px}"],changeDetection:0}),t})();function gt(t,e){1&t&&(c.O4$(),c.TgZ(0,"svg",14),c._UZ(1,"path",15),c._UZ(2,"path",16),c.qZA())}function pt(t,e){1&t&&(c.O4$(),c.TgZ(0,"svg",14),c._UZ(1,"path",15),c._UZ(2,"path",17),c.qZA())}function ht(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"li",12),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).changeSorting(e.key)}),c.ALo(1,"async"),c.TgZ(2,"span"),c._uU(3),c.qZA(),c.YNc(4,gt,3,0,"svg",13),c.ALo(5,"async"),c.YNc(6,pt,3,0,"svg",13),c.ALo(7,"async"),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw(2);c.ekj("active",c.lcZ(1,5,n.orderBy$)===t.key),c.xp6(3),c.Oqu(t.value),c.xp6(1),c.Q6J("ngIf",c.lcZ(5,7,n.orderDirection$)===n.ORDER_DIRECTION.ASC),c.xp6(2),c.Q6J("ngIf",c.lcZ(7,9,n.orderDirection$)===n.ORDER_DIRECTION.DESC)}}function ut(t,e){1&t&&(c.O4$(),c.kcU(),c.TgZ(0,"div",18),c._uU(1," There are no jobs yet. "),c.qZA())}function ft(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-job-unassigned",21),c.NdJ("update",function(){return c.CHM(t),c.oxw(3).updateJobs()}),c.qZA()}2&t&&c.Q6J("job",e.$implicit)}function bt(t,e){if(1&t&&(c.O4$(),c.kcU(),c.TgZ(0,"div",19),c.YNc(1,ft,1,1,"bc-job-unassigned",20),c.qZA()),2&t){const t=c.oxw().ngIf;c.xp6(1),c.Q6J("ngForOf",t.pendingJobs)}}function xt(t,e){if(1&t){const t=c.EpF();c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"ul",2),c.YNc(3,ht,8,11,"li",3),c.ALo(4,"keyvalue"),c.qZA(),c.TgZ(5,"div",4),c.O4$(),c.TgZ(6,"svg",5),c.NdJ("click",function(){const e=c.CHM(t).ngIf,n=c.oxw();return e.hasPreviousPage?n.paginate$.next(n.previousPage):null}),c._UZ(7,"path",6),c._UZ(8,"path",7),c.qZA(),c.TgZ(9,"svg",8),c.NdJ("click",function(){const e=c.CHM(t).ngIf,n=c.oxw();return e.hasNextPage?n.paginate$.next(n.nextPage):null}),c._UZ(10,"path",6),c._UZ(11,"path",9),c.qZA(),c.qZA(),c.qZA(),c.YNc(12,ut,2,0,"div",10),c.YNc(13,bt,2,1,"div",11),c.BQk()}if(2&t){const t=e.ngIf,n=c.oxw();c.xp6(3),c.Q6J("ngForOf",c.lcZ(4,7,n.orderKeys)),c.xp6(3),c.ekj("disabled",!t.hasPreviousPage),c.xp6(3),c.ekj("disabled",!t.hasNextPage),c.xp6(3),c.Q6J("ngIf",!t.pendingJobs.length),c.xp6(1),c.Q6J("ngIf",t.pendingJobs&&t.pendingJobs.length)}}const mt=function(){return[]},Zt=function(t,e,n){return{pendingJobs:t,hasPreviousPage:e,hasNextPage:n}};var yt=(()=>(function(t){t.DESC="-",t.ASC="+"}(yt||(yt={})),yt))();let wt=(()=>{class t{constructor(t,e,n){this.fb=t,this.jobsGQL=e,this.cdRef=n,this.jobs$=new a.X([]),this.ORDER_DIRECTION=yt,this.orderKeys={"job.requestDate":"Date","job.address":"Address"},this.orderBy$=new a.X("job.requestDate"),this.orderDirection$=new a.X(yt.DESC),this.hasNextPage$=new a.X(!1),this.hasPreviousPage$=new a.X(!1),this.paginate$=new a.X(0),this.destroy$=new r.xQ,this.calendarFilter=""}ngOnInit(){this.calendarType.subscribe(t=>{this.calendarFilter=t}),this.search$||(this.search$=new a.X("")),(0,y.aj)(this.orderBy$,this.orderDirection$,this.paginate$,this.search$,this.update,this.calendarType,this.staffFilter$).pipe((0,b.R)(this.destroy$),(0,x.w)(()=>this.getJobs())).subscribe(t=>{this.jobs$.next(t.data.jobs.items),this.cdRef.markForCheck()})}changeSorting(t){(0,y.aj)(this.orderBy$,this.orderDirection$).pipe((0,h.q)(1)).subscribe(([e,n])=>{e===t?this.orderDirection$.next(n===yt.ASC?yt.DESC:yt.ASC):this.orderBy$.next(t),this.cdRef.markForCheck()})}updateJobs(){this.getJobs().subscribe(t=>{this.jobs$.next(t.data.jobs.items),this.cdRef.markForCheck()}),this.update.next(void 0)}getJobs(){return(0,y.aj)(this.orderBy$,this.orderDirection$,this.paginate$,this.search$.pipe((0,ct.x)()),this.calendarType,this.staffFilter$).pipe((0,h.q)(1),(0,p.b)(([t,e,n,o,i,s])=>this.jobsGQL.fetch({status:[f.By.Pending,f.By.UnAssigned],search:o,orderBy:`${e}${t}`,pagination:{page:n},staff:s})),(0,g.b)(t=>{this.hasNextPage$.next(t.data.jobs.pageInfo.hasNextPage),this.hasPreviousPage$.next(t.data.jobs.pageInfo.hasPreviousPage),this.nextPage=t.data.jobs.pageInfo.nextPage,this.previousPage=t.data.jobs.pageInfo.previousPage}))}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(u.qu),c.Y36(f.VE),c.Y36(c.sBO))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-job-unassigned-list"]],inputs:{update:"update",search$:"search$",calendarType:"calendarType",staffFilter$:"staffFilter$"},decls:4,vars:12,consts:[[4,"ngIf"],[1,"pagination-controls","actions"],[1,"sorting"],[3,"active","click",4,"ngFor","ngForOf"],[1,"pagination"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"prev",3,"click"],["d","M0 0h24v24H0z","fill","none"],["d","M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"next",3,"click"],["d","M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["class","empty",4,"ngIf"],["class","jobs",4,"ngIf"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M0 0h24v24H0V0z","fill","none"],["d","m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"],["d","m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"],[1,"empty"],[1,"jobs"],[3,"job","update",4,"ngFor","ngForOf"],[3,"job","update"]],template:function(t,e){1&t&&(c.YNc(0,xt,14,9,"ng-container",0),c.ALo(1,"async"),c.ALo(2,"async"),c.ALo(3,"async")),2&t&&c.Q6J("ngIf",c.kEZ(8,Zt,c.lcZ(1,1,e.jobs$)||c.DdM(7,mt),c.lcZ(2,3,e.hasPreviousPage$),c.lcZ(3,5,e.hasNextPage$)))},directives:[o.O5,o.sg,lt],pipes:[o.Ov,o.Nd],styles:[".component-wrapper[_ngcontent-%COMP%]{border-top:1px solid #cfd8dc}.jobs[_ngcontent-%COMP%]{display:grid;grid-template-columns:327px 327px 327px;grid-gap:48px;margin-top:14px}.empty[_ngcontent-%COMP%]{font-size:16px;line-height:22px;margin-top:24px}"],changeDetection:0}),t})();function vt(t,e){1&t&&(c.TgZ(0,"span"),c._uU(1,"Job is completed"),c.qZA())}function kt(t,e){1&t&&(c.TgZ(0,"span"),c._uU(1,"Job is in progress"),c.qZA())}function Ct(t,e){1&t&&(c.TgZ(0,"span"),c._uU(1,"Job is cancelled"),c.qZA())}function Ot(t,e){1&t&&(c.TgZ(0,"span"),c._uU(1,"Job is assigned"),c.qZA())}function Tt(t,e){if(1&t&&(c.TgZ(0,"div",4),c.TgZ(1,"div",9),c._uU(2),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Oqu(t.job.builder.name)}}function Mt(t,e){if(1&t&&(c.TgZ(0,"div",4),c._UZ(1,"ion-icon",5),c.TgZ(2,"div",6),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("src","/assets/icon/truck-disabled.svg"),c.xp6(2),c.Oqu(t.equipment)}}function qt(t,e){if(1&t&&(c.TgZ(0,"div",4),c.TgZ(1,"div",6),c._uU(2),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Oqu(t.job.notes)}}let _t=(()=>{class t{constructor(t,e){this.overlay=t,this.injector=e,this.update=new c.vpe,this.destroy$=new r.xQ,this.jobStatus=f.By}get equipment(){return Array.isArray(this.job.equipment)?this.job.equipment.map(t=>t.name).join(", "):[]}get date(){return m(this.job.requestDate).utc().format("MMM D, dddd")}showClockOffModal(){const t=this.overlay.position().global().centerHorizontally().centerVertically(),e=this.overlay.scrollStrategies.close();this.dialogRef=this.overlay.create(new D.X_({disposeOnNavigation:!0,scrollStrategy:e,positionStrategy:t,hasBackdrop:!1,panelClass:"bc-dialog",backdropClass:"bc-dialog-backdrop"}));const n=new j.C5(et,null,this.createInjector({job:this.job})),o=this.dialogRef.attach(n);(0,l.T)(this.destroy$,o.instance.unassigned.pipe((0,h.q)(1))).subscribe(t=>{this.dialogRef.dispose(),t&&this.update.next()}),(0,l.T)(this.destroy$,o.instance.updateRequestDate.pipe((0,h.q)(1))).subscribe(t=>{this.dialogRef.dispose(),t&&this.update.next()}),o.instance.close.pipe((0,h.q)(1)).subscribe(()=>{this.dialogRef.dispose()})}createInjector(t){const e=new WeakMap([[P.dR,t]]);return new j.nK(this.injector,e)}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(D.aV),c.Y36(c.zs3))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-job-assigned"]],inputs:{job:"job"},outputs:{update:"update"},decls:22,vars:14,consts:[[1,"job-card-wrapper"],[1,"job-card"],[4,"ngIf"],["class","job-card-line",4,"ngIf"],[1,"job-card-line"],[3,"src"],[1,"job-card-desc"],[1,"bottom-row",3,"click"],["src","/assets/icon/goto.svg"],[2,"font-weight","bold","text-align","center"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div"),c.YNc(3,vt,2,0,"span",2),c.YNc(4,kt,2,0,"span",2),c.YNc(5,Ct,2,0,"span",2),c.YNc(6,Ot,2,0,"span",2),c.qZA(),c.YNc(7,Tt,3,1,"div",3),c.YNc(8,Mt,4,2,"div",3),c.TgZ(9,"div",4),c._UZ(10,"ion-icon",5),c.TgZ(11,"div",6),c._uU(12),c.qZA(),c.qZA(),c.TgZ(13,"div",4),c._UZ(14,"ion-icon",5),c.TgZ(15,"div",6),c._uU(16),c.qZA(),c.qZA(),c.YNc(17,qt,3,1,"div",3),c.qZA(),c.TgZ(18,"div",7),c.NdJ("click",function(){return e.showClockOffModal()}),c.TgZ(19,"span"),c._uU(20,"Job history"),c.qZA(),c._UZ(21,"ion-icon",8),c.qZA(),c.qZA()),2&t&&(c.xp6(2),c.Gre("status-header status-header--",e.job.status,""),c.xp6(1),c.Q6J("ngIf",e.job.status===e.jobStatus.Completed),c.xp6(1),c.Q6J("ngIf",e.job.status===e.jobStatus.InProgress),c.xp6(1),c.Q6J("ngIf",e.job.status===e.jobStatus.Cancelled),c.xp6(1),c.Q6J("ngIf",e.job.status===e.jobStatus.Assigned),c.xp6(1),c.Q6J("ngIf",null==e.job||null==e.job.builder?null:e.job.builder.name),c.xp6(1),c.Q6J("ngIf",e.equipment),c.xp6(2),c.Q6J("src","/assets/icon/location-disabled.svg"),c.xp6(2),c.Oqu(e.job.address),c.xp6(2),c.Q6J("src","/assets/icon/calendar-disabled.svg"),c.xp6(2),c.Oqu(e.date),c.xp6(1),c.Q6J("ngIf",e.job.notes))},directives:[o.O5,C.gu],styles:[".bottom-row[_ngcontent-%COMP%]{border:1px solid #004853;border-top:0;padding:0 15px;height:48px;display:flex;flex-flow:row nowrap;align-items:center;background-color:#e8f54a;justify-content:flex-end;border-radius:0 0 8px 8px;cursor:pointer}.bottom-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;letter-spacing:.40625px;text-transform:uppercase;margin-right:14px}.job-card[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-radius:8px 8px 0 0}.job-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:24px;height:24px}.job-card[_ngcontent-%COMP%]   .job-card-line[_ngcontent-%COMP%]{padding:16px;display:flex;flex-flow:row nowrap;border-left:1px solid #004853;border-right:1px solid #004853;border-bottom:1px solid #004853}.job-card[_ngcontent-%COMP%]   .job-card-line[_ngcontent-%COMP%]:last-of-type{border-bottom-width:0}.job-card[_ngcontent-%COMP%]   .job-card-line[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:first-of-type{margin-right:13px}.job-card[_ngcontent-%COMP%]   .job-card-desc[_ngcontent-%COMP%]{flex:0 1 auto;text-overflow:ellipsis;font-size:16px;line-height:22px;overflow:hidden;white-space:nowrap;width:16rem;padding-right:8px}[_nghost-%COMP%]{width:327px}.status-header[_ngcontent-%COMP%]{color:#fff;font-size:14px;height:24px;width:100%;padding:2px 12px;border-radius:8px 8px 0 0}.status-header.status-header--completed[_ngcontent-%COMP%]{background-color:#43a047}.status-header.status-header--inProgress[_ngcontent-%COMP%]{background-color:#1565c0}.status-header.status-header--cancelled[_ngcontent-%COMP%]{background-color:red}.status-header.status-header--assigned[_ngcontent-%COMP%]{background-color:orange}"],changeDetection:0}),t})();function At(t,e){1&t&&(c.O4$(),c.TgZ(0,"svg",14),c._UZ(1,"path",15),c._UZ(2,"path",16),c.qZA())}function Dt(t,e){1&t&&(c.O4$(),c.TgZ(0,"svg",14),c._UZ(1,"path",15),c._UZ(2,"path",17),c.qZA())}function jt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"li",12),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).changeSorting(e.key)}),c.ALo(1,"async"),c.TgZ(2,"span"),c._uU(3),c.qZA(),c.YNc(4,At,3,0,"svg",13),c.ALo(5,"async"),c.YNc(6,Dt,3,0,"svg",13),c.ALo(7,"async"),c.qZA()}if(2&t){const t=e.$implicit,n=c.oxw(2);c.ekj("active",c.lcZ(1,5,n.orderBy$)===t.key),c.xp6(3),c.Oqu(t.value),c.xp6(1),c.Q6J("ngIf",c.lcZ(5,7,n.orderDirection$)===n.ORDER_DIRECTION.ASC),c.xp6(2),c.Q6J("ngIf",c.lcZ(7,9,n.orderDirection$)===n.ORDER_DIRECTION.DESC)}}function Pt(t,e){1&t&&(c.O4$(),c.kcU(),c.TgZ(0,"div",18),c._uU(1," There are no jobs yet. "),c.qZA())}function Jt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-job-assigned",21),c.NdJ("update",function(){return c.CHM(t),c.oxw(3).updateJobs()}),c.qZA()}2&t&&c.Q6J("job",e.$implicit)}function $t(t,e){if(1&t&&(c.O4$(),c.kcU(),c.TgZ(0,"div",19),c.YNc(1,Jt,1,1,"bc-job-assigned",20),c.qZA()),2&t){const t=c.oxw().ngIf;c.xp6(1),c.Q6J("ngForOf",t.assignedJobs)}}function It(t,e){if(1&t){const t=c.EpF();c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"ul",2),c.YNc(3,jt,8,11,"li",3),c.ALo(4,"keyvalue"),c.qZA(),c.TgZ(5,"div",4),c.O4$(),c.TgZ(6,"svg",5),c.NdJ("click",function(){const e=c.CHM(t).ngIf,n=c.oxw();return e.hasPreviousPage?n.paginate$.next(n.previousPage):null}),c._UZ(7,"path",6),c._UZ(8,"path",7),c.qZA(),c.TgZ(9,"svg",8),c.NdJ("click",function(){const e=c.CHM(t).ngIf,n=c.oxw();return e.hasNextPage?n.paginate$.next(n.nextPage):null}),c._UZ(10,"path",6),c._UZ(11,"path",9),c.qZA(),c.qZA(),c.qZA(),c.YNc(12,Pt,2,0,"div",10),c.YNc(13,$t,2,1,"div",11),c.BQk()}if(2&t){const t=e.ngIf,n=c.oxw();c.xp6(3),c.Q6J("ngForOf",c.lcZ(4,7,n.orderKeys)),c.xp6(3),c.ekj("disabled",!t.hasPreviousPage),c.xp6(3),c.ekj("disabled",!t.hasNextPage),c.xp6(3),c.Q6J("ngIf",!t.assignedJobs.length),c.xp6(1),c.Q6J("ngIf",t.assignedJobs&&t.assignedJobs.length)}}const Nt=function(){return[]},Qt=function(t,e,n){return{assignedJobs:t,hasPreviousPage:e,hasNextPage:n}};let Ut=(()=>{class t{constructor(t,e){this.jobsGQL=t,this.cdRef=e,this.jobs$=new a.X([]),this.ORDER_DIRECTION=v.H,this.orderKeys={"job.requestDate":"Date","job.address":"Address"},this.orderBy$=new a.X("job.requestDate"),this.orderDirection$=new a.X(v.H.DESC),this.hasNextPage$=new a.X(!1),this.hasPreviousPage$=new a.X(!1),this.paginate$=new a.X(0),this.destroy$=new r.xQ,this.calendarFilter=""}ngOnInit(){this.calendarType.subscribe(t=>{this.calendarFilter=t}),this.search$||(this.search$=new a.X("")),(0,y.aj)(this.orderBy$,this.orderDirection$,this.paginate$,this.search$.pipe((0,ct.x)()),this.staffFilter$,this.update,this.calendarType).pipe((0,b.R)(this.destroy$),(0,x.w)(()=>this.getJobs())).subscribe(t=>{this.jobs$.next(t.data.jobs.items),this.cdRef.markForCheck()})}changeSorting(t){(0,y.aj)(this.orderBy$,this.orderDirection$).pipe((0,h.q)(1)).subscribe(([e,n])=>{e===t?this.orderDirection$.next(n===v.H.ASC?v.H.DESC:v.H.ASC):this.orderBy$.next(t),this.cdRef.markForCheck()})}updateJobs(){this.getJobs().subscribe(t=>{this.jobs$.next(t.data.jobs.items),this.cdRef.markForCheck()}),this.update.next(void 0)}getJobs(){return(0,y.aj)(this.orderBy$,this.orderDirection$,this.paginate$,this.search$.pipe((0,ct.x)()),this.staffFilter$,this.calendarType).pipe((0,h.q)(1),(0,p.b)(([t,e,n,o,i])=>this.jobsGQL.fetch({status:[f.By.Completed,f.By.InProgress,f.By.Cancelled,f.By.Assigned],orderBy:`${e}${t}`,search:o,pagination:{page:n},staff:i})),(0,g.b)(t=>{this.hasNextPage$.next(t.data.jobs.pageInfo.hasNextPage),this.hasPreviousPage$.next(t.data.jobs.pageInfo.hasPreviousPage),this.nextPage=t.data.jobs.pageInfo.nextPage,this.previousPage=t.data.jobs.pageInfo.previousPage}))}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.VE),c.Y36(c.sBO))},t.\u0275cmp=c.Xpm({type:t,selectors:[["bc-job-assigned-list"]],inputs:{update:"update",staffFilter$:"staffFilter$",search$:"search$",calendarType:"calendarType"},decls:4,vars:12,consts:[[4,"ngIf"],[1,"pagination-controls","actions"],[1,"sorting"],[3,"active","click",4,"ngFor","ngForOf"],[1,"pagination"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"prev",3,"click"],["d","M0 0h24v24H0z","fill","none"],["d","M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"next",3,"click"],["d","M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["class","empty",4,"ngIf"],["class","jobs",4,"ngIf"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M0 0h24v24H0V0z","fill","none"],["d","m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"],["d","m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"],[1,"empty"],[1,"jobs"],[3,"job","update",4,"ngFor","ngForOf"],[3,"job","update"]],template:function(t,e){1&t&&(c.YNc(0,It,14,9,"ng-container",0),c.ALo(1,"async"),c.ALo(2,"async"),c.ALo(3,"async")),2&t&&c.Q6J("ngIf",c.kEZ(8,Qt,c.lcZ(1,1,e.jobs$)||c.DdM(7,Nt),c.lcZ(2,3,e.hasPreviousPage$),c.lcZ(3,5,e.hasNextPage$)))},directives:[o.O5,o.sg,_t],pipes:[o.Ov,o.Nd],styles:[".component-wrapper[_ngcontent-%COMP%]{border-top:1px solid #cfd8dc}.jobs[_ngcontent-%COMP%]{display:grid;grid-template-columns:327px 327px 327px;grid-gap:48px;margin-top:14px}.empty[_ngcontent-%COMP%]{font-size:16px;line-height:22px;margin-top:24px}"],changeDetection:0}),t})();const Yt=["jobCard"];function Ft(t,e){if(1&t&&(c.TgZ(0,"ion-select-option",13),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.s9C("value",t.id),c.xp6(1),c.Oqu(t.name)}}function St(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.hij("",t.name,", ")}}function Rt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",31),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).showAssignedModal(e)}),c.TgZ(1,"ion-reorder",32),c._UZ(2,"ion-icon",33),c.qZA(),c.TgZ(3,"ion-title"),c.TgZ(4,"div",34),c._uU(5),c.qZA(),c.TgZ(6,"div",35),c._uU(7),c.qZA(),c.TgZ(8,"div"),c.YNc(9,St,2,1,"span",25),c.qZA(),c.qZA(),c.TgZ(10,"div",36,37),c.TgZ(12,"div",38),c._UZ(13,"ion-icon",39),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(5),c.hij(" ",t.builder.name," "),c.xp6(2),c.hij(" ",t.address," "),c.xp6(2),c.Q6J("ngForOf",t.equipment),c.xp6(4),c.Q6J("src","/assets/icon/assign.svg")}}function Et(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.hij("",t.name,", ")}}function Lt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",40),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).showClockOffModal(e)}),c.TgZ(1,"ion-reorder",32),c._UZ(2,"ion-icon",33),c.qZA(),c.TgZ(3,"ion-title"),c.TgZ(4,"div",34),c._uU(5),c.qZA(),c.TgZ(6,"div",35),c._uU(7),c.qZA(),c.TgZ(8,"div"),c.YNc(9,Et,2,1,"span",25),c.qZA(),c.qZA(),c.TgZ(10,"div",41),c._UZ(11,"ion-icon",42),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(5),c.hij(" ",t.builder.name," "),c.xp6(2),c.hij(" ",t.address," "),c.xp6(2),c.Q6J("ngForOf",t.equipment)}}function Bt(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.hij("",t.name,", ")}}function Ht(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",43),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).showClockOffModal(e)}),c.TgZ(1,"ion-reorder",32),c._UZ(2,"ion-icon",33),c.qZA(),c.TgZ(3,"ion-title"),c.TgZ(4,"div",34),c._uU(5),c.qZA(),c.TgZ(6,"div",35),c._uU(7),c.qZA(),c.TgZ(8,"div"),c.YNc(9,Bt,2,1,"span",25),c.qZA(),c.qZA(),c.TgZ(10,"div",41),c._UZ(11,"ion-icon",42),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(5),c.hij(" ",t.builder.name," "),c.xp6(2),c.hij(" ",t.address," "),c.xp6(2),c.Q6J("ngForOf",t.equipment)}}function Gt(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.hij("",t.name,", ")}}function zt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-item",44),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw(4).showClockOffModal(e)}),c.TgZ(1,"ion-reorder",32),c._UZ(2,"ion-icon",33),c.qZA(),c.TgZ(3,"ion-title"),c.TgZ(4,"div",34),c._uU(5),c.qZA(),c.TgZ(6,"div",35),c._uU(7),c.qZA(),c.TgZ(8,"div"),c.YNc(9,Gt,2,1,"span",25),c.qZA(),c.qZA(),c.TgZ(10,"div",41),c._UZ(11,"ion-icon",42),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2).$implicit;c.xp6(5),c.hij(" ",t.builder.name," "),c.xp6(2),c.hij(" ",t.address," "),c.xp6(2),c.Q6J("ngForOf",t.equipment)}}function Wt(t,e){if(1&t&&(c.TgZ(0,"ion-row"),c.TgZ(1,"ion-col",26),c.TgZ(2,"ion-title"),c.TgZ(3,"div"),c._uU(4),c.ALo(5,"date"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"ion-col"),c.YNc(7,Rt,14,4,"ion-item",27),c.YNc(8,Lt,12,3,"ion-item",28),c.YNc(9,Ht,12,3,"ion-item",29),c.YNc(10,zt,12,3,"ion-item",30),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(4),c.hij(" ",c.xi3(5,5,t.requestDate,"h:mm a")," "),c.xp6(3),c.Q6J("ngIf","pending"===t.status||"unAssigned"==t.status),c.xp6(1),c.Q6J("ngIf","assigned"===t.status),c.xp6(1),c.Q6J("ngIf","cancelled"===t.status),c.xp6(1),c.Q6J("ngIf","completed"===t.status)}}function Xt(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Wt,11,8,"ion-row",25),c.qZA()),2&t){const t=c.oxw(4);c.xp6(1),c.Q6J("ngForOf",t.day)}}function Vt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-grid"),c.TgZ(1,"ion-reorder-group",24),c.NdJ("ionItemReorder",function(e){return c.CHM(t),c.oxw(3).reorderItems(e)}),c.YNc(2,Xt,2,1,"div",25),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(3);c.xp6(2),c.Q6J("ngForOf",t.dayResponseToShow)}}function Kt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-card"),c.TgZ(1,"ion-item"),c.TgZ(2,"ion-searchbar",18),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).searchForItem(e)}),c.qZA(),c.qZA(),c.TgZ(3,"ion-item"),c.TgZ(4,"ion-button",19),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).prevDay()}),c._UZ(5,"ion-icon",20),c.qZA(),c.TgZ(6,"ion-title",21),c.TgZ(7,"div",22),c._uU(8),c.ALo(9,"date"),c.qZA(),c.qZA(),c.TgZ(10,"ion-button",19),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).nextDay()}),c._UZ(11,"ion-icon",23),c.qZA(),c.qZA(),c.YNc(12,Vt,3,1,"ion-grid",9),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(8),c.hij(" ",c.xi3(9,2,t.selectedDate,"d MMM")," "),c.xp6(4),c.Q6J("ngIf",t.day)}}function te(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-col",46),c.TgZ(1,"ion-title",47),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(4).hopToDay(e.date,e.month)}),c.TgZ(2,"div",21),c._uU(3),c.TgZ(4,"sup"),c._uU(5,"th"),c.qZA(),c.qZA(),c.TgZ(6,"div",21),c._uU(7),c.qZA(),c.qZA(),c._UZ(8,"div",48),c.qZA()}if(2&t){const t=e.$implicit,n=e.index,o=c.oxw(4);c.xp6(3),c.hij(" ",t.date,""),c.xp6(4),c.hij(" ",o.weekNames[n]," "),c.xp6(1),c.s9C("id",t.date)}}function ee(t,e){if(1&t&&(c.TgZ(0,"ion-grid"),c.TgZ(1,"div"),c.TgZ(2,"ion-row"),c.YNc(3,te,9,3,"ion-col",45),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw(3);c.xp6(3),c.Q6J("ngForOf",t.week)}}function ne(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-card"),c.TgZ(1,"ion-item"),c.TgZ(2,"ion-searchbar",18),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).searchForItem(e)}),c.qZA(),c.qZA(),c.TgZ(3,"ion-item"),c.TgZ(4,"ion-button",19),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).prevWeek()}),c._UZ(5,"ion-icon",20),c.qZA(),c.TgZ(6,"ion-title",21),c.TgZ(7,"div",22),c._uU(8),c.ALo(9,"date"),c.ALo(10,"date"),c.qZA(),c.qZA(),c.TgZ(11,"ion-button",19),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).nextWeek()}),c._UZ(12,"ion-icon",23),c.qZA(),c.qZA(),c.YNc(13,ee,4,1,"ion-grid",9),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(8),c.AsE(" ",c.xi3(9,3,t.firstDayOfWeek(t.selectedDate),"d MMM")," - ",c.xi3(10,6,t.lastDayOfWeek(t.firstDayOfWeek(t.selectedDate)),"d MMM")," "),c.xp6(5),c.Q6J("ngIf",t.week)}}function oe(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",57),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).hopToDay(e.date,e.month)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.hij(" ",t.date," ")}}function ie(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",57),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).hopToDay(e.date,e.month)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.hij(" ",t.date," ")}}function se(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",57),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).hopToDay(e.date,e.month)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.hij(" ",t.date," ")}}function ce(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",58),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).hopToDay(e.date,e.month)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.hij(" ",t.date," ")}}function ae(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",58),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).hopToDay(e.date,e.month)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.hij(" ",t.date," ")}}function re(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",59),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw(5).hopToDay(e.date,e.month)}),c._uU(1),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.hij(" ",t.date," ")}}function de(t,e){if(1&t&&(c.TgZ(0,"ion-col",53),c.YNc(1,oe,2,1,"div",54),c.YNc(2,ie,2,1,"div",54),c.YNc(3,se,2,1,"div",54),c.YNc(4,ce,2,1,"div",55),c.YNc(5,ae,2,1,"div",55),c.YNc(6,re,2,1,"div",56),c._UZ(7,"div",48),c.qZA()),2&t){const t=e.$implicit,n=c.oxw(5);c.xp6(1),c.Q6J("ngIf",n.today.getMonth()==t.month&&n.today.getDay()!=t.date&&n.selectedDate.getMonth()==t.month),c.xp6(1),c.Q6J("ngIf",n.today.getMonth()!=t.month&&n.today.getDay()==t.date&&n.selectedDate.getMonth()==t.month),c.xp6(1),c.Q6J("ngIf",n.today.getMonth()!=t.month&&n.today.getDay()!=t.date&&n.selectedDate.getMonth()==t.month),c.xp6(1),c.Q6J("ngIf",n.selectedDate.getMonth()!=t.month&&n.today.getDay()!=t.date),c.xp6(1),c.Q6J("ngIf",n.selectedDate.getMonth()!=t.month&&n.today.getDay()==t.date),c.xp6(1),c.Q6J("ngIf",n.today.getMonth()==t.month&&n.today.getDay()==t.date&&n.selectedDate.getMonth()==t.month),c.xp6(1),c.hYB("id","",t.date,"-",t.month,"")}}function le(t,e){if(1&t&&(c.TgZ(0,"ion-row"),c.YNc(1,de,8,8,"ion-col",52),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngForOf",t)}}function ge(t,e){if(1&t&&(c.TgZ(0,"ion-grid",51),c.YNc(1,le,2,1,"ion-row",25),c.qZA()),2&t){const t=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",t.calendar)}}function pe(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"ion-card"),c.TgZ(1,"ion-item"),c.TgZ(2,"ion-searchbar",18),c.NdJ("ionChange",function(e){return c.CHM(t),c.oxw(2).searchForItem(e)}),c.qZA(),c.qZA(),c.TgZ(3,"ion-item"),c.TgZ(4,"ion-button",19),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).prevMonth()}),c._UZ(5,"ion-icon",20),c.qZA(),c.TgZ(6,"ion-title",21),c.TgZ(7,"div",22),c._uU(8),c.ALo(9,"date"),c.qZA(),c.TgZ(10,"div",49),c._uU(11),c.ALo(12,"date"),c.qZA(),c.qZA(),c.TgZ(13,"ion-button",19),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).nextMonth()}),c._UZ(14,"ion-icon",23),c.qZA(),c.qZA(),c.YNc(15,ge,2,1,"ion-grid",50),c.qZA()}if(2&t){const t=c.oxw(2);c.xp6(8),c.hij(" ",c.xi3(9,3,t.selectedDate,"MMMM")," "),c.xp6(3),c.hij(" ",c.xi3(12,6,t.selectedDate,"YYYY")," "),c.xp6(4),c.Q6J("ngIf",t.calendar&&t.calendar.length>0)}}function he(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-segment",14),c.TgZ(2,"ion-segment-button",15),c.NdJ("click",function(){return c.CHM(t),c.oxw().calendarJobs("day")}),c.TgZ(3,"ion-label"),c._uU(4,"Day"),c.qZA(),c.qZA(),c.TgZ(5,"ion-segment-button",16),c.NdJ("click",function(){return c.CHM(t),c.oxw().calendarJobs("week")}),c.TgZ(6,"ion-label"),c._uU(7,"Week"),c.qZA(),c.qZA(),c.TgZ(8,"ion-segment-button",17),c.NdJ("click",function(){return c.CHM(t),c.oxw().calendarJobs("month")}),c.TgZ(9,"ion-label"),c._uU(10,"Month"),c.qZA(),c.qZA(),c.qZA(),c.YNc(11,Kt,13,5,"ion-card",9),c.YNc(12,ne,14,9,"ion-card",9),c.YNc(13,pe,16,9,"ion-card",9),c.qZA()}if(2&t){const t=c.oxw();c.xp6(1),c.Q6J("value",t.calendarQueryType),c.xp6(10),c.Q6J("ngIf","day"===t.calendarQueryType),c.xp6(1),c.Q6J("ngIf","week"===t.calendarQueryType),c.xp6(1),c.Q6J("ngIf","month"===t.calendarQueryType)}}function ue(t,e){if(1&t&&(c.TgZ(0,"div"),c.TgZ(1,"section",60),c.TgZ(2,"div",61),c.TgZ(3,"div",62),c._uU(4,"Unassigned jobs"),c.qZA(),c._UZ(5,"div",63),c.qZA(),c.TgZ(6,"div",64),c._UZ(7,"bc-job-unassigned-list",65),c.qZA(),c.qZA(),c.TgZ(8,"section",66),c.TgZ(9,"div",61),c.TgZ(10,"div",62),c._uU(11,"Assigned jobs"),c.qZA(),c._UZ(12,"div",63),c.qZA(),c.TgZ(13,"div",64),c._UZ(14,"bc-job-assigned-list",67),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(7),c.Q6J("search$",t.search$)("staffFilter$",t.staffFilter$)("update",t.updateJobs$)("calendarType",t.calendarType),c.xp6(7),c.Q6J("staffFilter$",t.staffFilter$)("search$",t.search$)("update",t.updateJobs$)("calendarType",t.calendarType)}}const fe=[{path:"",component:(()=>{class t{constructor(t,e,n,o,i,s,d,l,g){this.jobsGQL=t,this.updateJobGQL=e,this.searchService=n,this.overlay=o,this.injector=i,this.modalController=s,this.cdRef=d,this.usersGQL=l,this.actionSheetController=g,this.staffFilter$=new a.X(void 0),this.update=new c.vpe,this.updateJobs$=new a.X(void 0),this.search$=new a.X(""),this.eventType="past",this.calendarType=new a.X(""),this.destroy$=new r.xQ,this.selectedDate=new Date,this.selectedMonth=(new Date).getMonth(),this.calendar=[],this.today=new Date,this.calendarQueryType="month",this.lastCalendarRangeType=this.calendarQueryType,this.calendarResponse=[],this.calendarResponseToShow=[],this.monthReponse=[],this.weekResponse=[],this.weekResponseToShow=[],this.dayResponse=[],this.dayResponseToShow=[],this.week=[],this.day=[],this.weekNames=[],this.weekNames=["Monday","Tuesday","Wednesday","Thursday","Firday","Saturday","Sunday"],this.updateMonth(),this.getStaff()}toggleJobs(t){this.eventType=t,"past"===t?this.calendarType.next(""):this.updateMonth()}searchForItem(t){"month"===this.calendarQueryType?(this.calendarResponseToShow=this.searchItem(t.detail.value,this.calendarResponse),this.createArray(!1)):"week"===this.calendarQueryType?(this.weekResponseToShow=this.searchItem(t.detail.value,this.weekResponse),this.createWeekArray(!1)):"day"===this.calendarQueryType&&(this.dayResponseToShow=this.searchItem(t.detail.value,this.dayResponse),this.sortDayByPriority())}searchItem(t,e){return Object.assign(e).filter(e=>e.address.toLowerCase().includes(t))}calendarJobs(t){t&&(this.lastCalendarRangeType=t),t||(t=this.lastCalendarRangeType),this.calendarQueryType=t,"week"===t&&this.updateWeek(),"day"===t&&this.updateDay(),"month"==t&&this.updateMonth(),this.calendarType.next(t)}presentModal(){return(0,s.mG)(this,void 0,void 0,function*(){this.showModal().subscribe(t=>{}),setTimeout(()=>(0,s.mG)(this,void 0,void 0,function*(){yield this.modal.onDidDismiss().then(()=>{this.calendarJobs(this.calendarQueryType)})}),2e3)})}staffFilterApplied(t){if(!(null==t?void 0:t.length)||"-1"===t)return this.staffFilter$.next(void 0),void this.calendarJobs(this.calendarQueryType);this.staffFilter$.next([+t]),this.calendarJobs(this.calendarQueryType)}showModal(){return(0,d.D)(this.modalController.create({component:_,cssClass:"auto-height"})).pipe((0,b.R)(this.destroy$),(0,g.b)(t=>this.modal=t),(0,p.b)(t=>(0,d.D)(t.present())))}firstDayOfWeek(t){const e=t.getDay(),n=t.getDate()-e+(0==e?-6:1);return new Date(t.setDate(n))}lastDayOfWeek(t){const e=new Date(t);return e.setDate(t.getDate()+6),e}firstDayOfMonth(){return new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth(),1)}lastDayOfMonth(){return new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth()+1,0)}firstDayOfCalendar(){return this.firstDayOfWeek(this.firstDayOfMonth())}lastDayOfCalendar(){return this.lastDayOfWeek(this.firstDayOfWeek(this.lastDayOfMonth()))}pushInArray(t,e,n){return(0,s.mG)(this,void 0,void 0,function*(){this.calendar[t].push({date:e,month:n})})}createArray(t){this.calendar=[];var e=new Date(this.firstDayOfCalendar());const n=this.lastDayOfCalendar();n.setDate(n.getDate()+1);for(var o=0;e.valueOf()!=n.valueOf();){this.calendar[o]=[];for(var i=0;i<7;i++)e.getMonth(),this.pushInArray(o,e.getDate(),e.getMonth()),e.setDate(e.getDate()+1);o+=1}t?this.getJobs(this.firstDayOfCalendar(),this.lastDayOfMonth(),"month"):setTimeout(()=>{this.createMonthElements()},500)}nextMonth(){this.calendar=[],this.selectedMonth<11?this.selectedMonth=this.selectedMonth+1:(this.selectedMonth=0,this.selectedDate.setFullYear(this.selectedDate.getFullYear()+1)),this.updateMonth()}prevMonth(){this.calendar=[],this.selectedMonth>0?this.selectedMonth=this.selectedMonth-1:(this.selectedMonth=11,this.selectedDate.setFullYear(this.selectedDate.getFullYear()-1)),this.updateMonth()}getJobs(t,e,n){e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,59),console.log("cType========",n),console.log("startDate========",t),console.log("endDate========",e),"month"===n?this.calendarQueryType="month":"week"===n?this.calendarQueryType="week":(this.calendarQueryType="day",t.setDate(t.getDate()+1),e.setDate(t.getDate())),this.jobsGQL.fetch({status:[f.By.Completed,f.By.InProgress,f.By.Cancelled,f.By.Assigned,f.By.Pending,f.By.UnAssigned],pagination:{page:0,offset:31},filteredDate:{startDate:t,endDate:e,calendarType:this.calendarQueryType},staff:this.staffFilter$.value}).subscribe(t=>{const e=t.data.jobs.items.map(t=>(t.date=m(t.requestDate).utc().date(),t.month=m(t.requestDate).utc().month(),t.jobRequestedDate=m(t.requestDate).utc().format("MMM D, dddd"),t));console.log(e),"month"===n?(this.calendarResponse=e,this.calendarResponseToShow=e,this.calendarQueryType=n,setTimeout(()=>{this.createMonthElements()},500)):"week"===n?(this.weekResponse=e,this.weekResponseToShow=this.weekResponse,this.calendarQueryType=n,setTimeout(()=>{this.createWeekElements()},500)):(this.dayResponse=e,this.dayResponseToShow=e,this.calendarQueryType=n,setTimeout(()=>{this.sortDayByPriority()},5e3)),this.cdRef.detectChanges()})}getStaff(){this.usersGQL.fetch({role:"staff"}).subscribe(t=>{this.staff=t.data.users.items})}getJobsOfStaff(){}array_move(t,e,n){if(n>=t.length)for(var o=n-t.length+1;o--;)t.push(void 0);return t.splice(n,0,t.splice(e,1)[0]),t}sortDayByPriority(){for(var t=0;t<this.dayResponseToShow.length;t++)""!=this.dayResponseToShow[t].priority&&(this.dayResponseToShow=this.array_move(this.dayResponseToShow,t,Number(this.dayResponseToShow[t].priority)))}reorderItems(t){var e;return(0,s.mG)(this,void 0,void 0,function*(){this.dayResponseToShow=this.array_move(this.dayResponseToShow,t.detail.from,t.detail.to);for(var n=0;n<this.dayResponseToShow.length;n++){const t=this.dayResponseToShow[n],o=n.toString();this.jobId=t.id;const i={address:t.address,equipment:null===(e=t.equipment)||void 0===e?void 0:e.map(t=>t.id),lng:t.lng,lat:t.lat,requestDate:t.requestDate,notes:t.notes,priority:o};this.updateJobGQL.mutate({input:Object.assign(Object.assign({},i),{id:this.jobId})},{context:{useMultipart:!0}}).subscribe(t=>{})}t.detail.complete()})}returnAllEquipment(t){var e="";for(let n of t)e=e+n.name+",";return e}createMonthElements(){var t,e,n,o,i;for(let s of this.calendarResponseToShow){const c=document.createElement("jobID"+s.id.toString());"pending"==s.status||"unAssigned"==s.status?(c.innerHTML=`<div style = "font-size:14px;margin:5px;width:100%;text-align:center;border-radius:4px;background:yellow;padding:5px;cursor:pointer;">\n        ${null===(t=s.equipment[0])||void 0===t?void 0:t.name}\n    </div>`,c.onclick=()=>this.showAssignedModal(s)):"assigned"==s.status?(c.innerHTML=`<div style = "font-size:14px;margin:5px;width:100%;text-align:center;border-radius:4px;background:blue;color:white;padding:5px;cursor:pointer;">\n        ${null===(e=s.equipment[0])||void 0===e?void 0:e.name}\n    </div>`,c.onclick=()=>this.showClockOffModal(s)):"cancelled"==s.status?(c.innerHTML=`<div style = "font-size:14px;margin:5px;width:100%;text-align:center;border-radius:4px;background:red;color:white;padding:5px;cursor:pointer;">\n        ${null===(n=s.equipment[0])||void 0===n?void 0:n.name}\n    </div>`,c.onclick=()=>this.showClockOffModal(s)):"completed"==s.status&&(c.innerHTML=`<div style = "font-size:14px;margin:5px;width:100%;text-align:center;border-radius:4px;background:green;color:white;padding:5px;cursor:pointer;">\n        ${null===(o=s.equipment[0])||void 0===o?void 0:o.name}\n    </div>`,c.onclick=()=>this.showClockOffModal(s)),null===(i=document.getElementById(s.date.toString()+"-"+s.month.toString()))||void 0===i||i.appendChild(c)}}createWeekElements(){var t;for(let e of this.weekResponseToShow){const n=document.createElement("jobID"+e.id.toString());"pending"==e.status||"unAssigned"==e.status?(n.innerHTML=`<div style = "font-size:10px;margin:5px;text-align:center;border-radius:4px;background:yellow;padding:5px;cursor:pointer;">\n        <span style = 'font-weight:bolder;text-decoration: underline;'>${e.builder.name}</span><br>\n        <span style = 'font-style: italic;'>${e.address}</span><br>\n        ${this.returnAllEquipment(e.equipment)}\n    </div>`,n.onclick=()=>this.showAssignedModal(e)):"assigned"==e.status?(n.innerHTML=`<div style = "font-size:10px;margin:5px;text-align:center;border-radius:4px;background:blue;color:white;padding:5px;cursor:pointer;">\n        <span style = 'font-weight:bolder;text-decoration: underline;'>${e.builder.name}</span><br>\n        <span style = 'font-style: italic;'>${e.address}</span><br>\n        ${this.returnAllEquipment(e.equipment)}\n    </div>`,n.onclick=()=>this.showClockOffModal(e)):"cancelled"==e.status?(n.innerHTML=`<div style = "font-size:10px;margin:5px;text-align:center;border-radius:4px;background:red;color:white;padding:5px;cursor:pointer;">\n        <span style = 'font-weight:bolder;text-decoration: underline;'>${e.builder.name}</span><br>\n        <span style = 'font-style: italic;'>${e.address}</span><br>\n        ${this.returnAllEquipment(e.equipment)}\n    </div>`,n.onclick=()=>this.showClockOffModal(e)):"completed"==e.status&&(n.innerHTML=`<div style = "font-size:10px;margin:5px;text-align:center;border-radius:4px;background:green;color:white;padding:5px;cursor:pointer;">\n        <span style = 'font-weight:bolder;text-decoration: underline;'>${e.builder.name}</span><br>\n        <span style = 'font-style: italic;'>${e.address}</span><br>\n        ${this.returnAllEquipment(e.equipment)}\n    </div>`,n.onclick=()=>this.showClockOffModal(e)),null===(t=document.getElementById(e.date.toString()))||void 0===t||t.appendChild(n)}}updateMonth(){this.selectedDate=new Date(this.selectedDate.getFullYear(),this.selectedMonth,this.selectedDate.getDate()),this.calendarResponse=[],this.createArray(!0)}pushInWeekArray(t,e){return(0,s.mG)(this,void 0,void 0,function*(){this.week.push({date:t,month:e})})}pushInWeekDay(t,e){return(0,s.mG)(this,void 0,void 0,function*(){this.day.push({date:t,month:e})})}createWeekArray(t){this.week=[];const e=this.firstDayOfWeek(this.selectedDate),n=this.lastDayOfWeek(e);for(var o=e,i=0;i<7;i++)this.pushInWeekArray(o.getDate(),o.getMonth()),o.setDate(o.getDate()+1);t?this.getJobs(this.selectedDate,n,"week"):setTimeout(()=>{this.createWeekElements()},500)}createDayArray(){this.day=[];var t=this.selectedDate;t=new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth(),this.selectedDate.getDate(),0,0,0,0);for(var e=0;e<1;e++)this.pushInWeekDay(t.getDate(),t.getMonth());this.getJobs(t,t,"day")}updateWeek(){this.createWeekArray(!0)}updateDay(){this.createDayArray()}nextWeek(){this.selectedDate=new Date(this.selectedDate.getTime()+6048e5),this.updateWeek()}prevWeek(){this.selectedDate=new Date(this.selectedDate.getTime()-6048e5),this.updateWeek()}hopToDay(t,e){this.selectedDate=new Date(this.selectedDate.getFullYear(),e,t),this.calendarJobs("day")}nextDay(){this.selectedDate=new Date(this.selectedDate.getTime()+864e5),this.updateDay()}prevDay(){this.selectedDate=new Date(this.selectedDate.getTime()-864e5),this.updateDay()}showClockOffModal(t){const e=this.overlay.position().global().centerHorizontally().centerVertically(),n=this.overlay.scrollStrategies.close();this.dialogRef=this.overlay.create(new D.X_({disposeOnNavigation:!0,scrollStrategy:n,positionStrategy:e,hasBackdrop:!1,panelClass:"bc-dialog",backdropClass:"bc-dialog-backdrop"}));const o=new j.C5(et,null,this.createInjector({job:t})),i=this.dialogRef.attach(o);(0,l.T)(this.destroy$,i.instance.unassigned.pipe((0,h.q)(1))).subscribe(t=>{if(this.dialogRef.dispose(),t)switch(this.calendarQueryType){case"month":this.updateMonth();break;case"day":this.updateDay();break;case"week":this.updateWeek()}}),i.instance.close.pipe((0,h.q)(1)).subscribe(()=>{this.calendarJobs(this.calendarQueryType),this.dialogRef.dispose()})}createInjector(t){const e=new WeakMap([[P.dR,t]]);return new j.nK(this.injector,e)}showAssignedModal(t){return(0,s.mG)(this,void 0,void 0,function*(){const e=yield this.actionSheetController.create({header:t.address,subHeader:t.builder.name,cssClass:"blueText",mode:"ios",buttons:[{text:"Assign",cssClass:"blueText",handler:()=>{const e=this.overlay.position().flexibleConnectedTo(this.cardContentRef).withPositions([new D.tR({originX:"center",originY:"top"},{overlayX:"center",overlayY:"top"})]),n=this.overlay.scrollStrategies.close();this.dialogRef=this.overlay.create(new D.X_({disposeOnNavigation:!0,scrollStrategy:n,positionStrategy:e,hasBackdrop:!1,panelClass:"bc-dialog",backdropClass:"bc-dialog-backdrop",height:327}));const o=new j.C5(it,null,this.createInjectorAssign({jobId:t.id})),i=this.dialogRef.attach(o);(0,l.T)(this.destroy$,i.instance.close.pipe((0,h.q)(1))).subscribe(t=>{if(this.dialogRef.dispose(),t)switch(this.calendarQueryType){case"month":this.updateMonth();break;case"day":this.updateDay();break;case"week":this.updateWeek()}})}},{text:"Edit",cssClass:"blueText",handler:()=>{this.showClockOffModal(t)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield e.present()})}createInjectorAssign(t){const e=new WeakMap([[P.CR,t]]);return new j.nK(this.injector,e)}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.VE),c.Y36(f.hh),c.Y36(A.oD),c.Y36(D.aV),c.Y36(c.zs3),c.Y36(C.IN),c.Y36(c.sBO),c.Y36(f.lY),c.Y36(C.BX))},t.\u0275cmp=c.Xpm({type:t,selectors:[["dfobobcat-admin-jobs"]],viewQuery:function(t,e){if(1&t&&c.Gf(Yt,5,c.SBq),2&t){let t;c.iGM(t=c.CRH())&&(e.cardContentRef=t.first)}},inputs:{job:"job"},outputs:{update:"update"},decls:19,vars:3,consts:[[3,"searchText"],[1,"component-wrapper"],["color","secondary","slot","start",3,"click"],["name","reorder-four"],["name","calendar"],["slot","start","value","-1","okText","Filter","cancelText","Close",3,"ionChange"],["selectInput",""],["value","-1","color","secondary"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",2,"position","fixed","bottom","15px","right","15px"],[3,"click"],["name","add"],[3,"value"],["color","secondary",3,"value"],["value","day",3,"click"],["value","week",3,"click"],["value","month",3,"click"],["mode","ios","animated","","slot","end",3,"ionChange"],["color","none",3,"click"],["name","chevron-back-outline","slot","start"],[2,"text-align","center"],[2,"font-weight","bolder","font-size","24px"],["name","chevron-forward-outline","slot","end"],["disabled","false",3,"ionItemReorder"],[4,"ngFor","ngForOf"],["size","3"],["color","warning","button","",3,"click",4,"ngIf"],["color","tertiary","button","",3,"click",4,"ngIf"],["color","danger","button","",3,"click",4,"ngIf"],["color","success","button","",3,"click",4,"ngIf"],["color","warning","button","",3,"click"],["slot","start"],["name","business-outline"],[2,"font-weight","bolder","text-decoration","underline"],[2,"font-style","italic"],[1,"job-assign"],["jobCard",""],[1,"assign-icon"],[3,"src"],["color","tertiary","button","",3,"click"],[1,"bottom-row"],["src","/assets/icon/goto.svg"],["color","danger","button","",3,"click"],["color","success","button","",3,"click"],["size","1.7","style","border-left: 1px solid rgb(161, 161, 161)",4,"ngFor","ngForOf"],["size","1.7",2,"border-left","1px solid rgb(161, 161, 161)"],[1,"clickableWeek",2,"border","1px solid rgb(161, 161, 161)",3,"click"],[3,"id"],[2,"font-size","18px"],["style","width: 100%",4,"ngIf"],[2,"width","100%"],["size","1.7","style","\n                            text-align: center;\n                            border: 1px solid rgba(131, 131, 131, 0.596);\n                            min-height: 100px;\n                            display: flex;\n                        ",4,"ngFor","ngForOf"],["size","1.7",2,"text-align","center","border","1px solid rgba(131, 131, 131, 0.596)","min-height","100px","display","flex"],["class","clickableDay",3,"click",4,"ngIf"],["class","clickableDay","style","opacity: 0.4",3,"click",4,"ngIf"],["class","clickableDay","style","\n                                border-bottom-right-radius: 5px;\n                                padding: 2px;\n                                color: white;\n                            ",3,"click",4,"ngIf"],[1,"clickableDay",3,"click"],[1,"clickableDay",2,"opacity","0.4",3,"click"],[1,"clickableDay",2,"border-bottom-right-radius","5px","padding","2px","color","white",3,"click"],[1,"unassigned"],[1,"section-header"],[1,"section-title"],[2,"flex","1 0 auto"],[1,"section-body"],[3,"search$","staffFilter$","update","calendarType"],[1,"assigned"],[3,"staffFilter$","search$","update","calendarType"]],template:function(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"bc-admin-header",0),c.NdJ("searchText",function(t){return e.search$.next(t)}),c.TgZ(1,"span"),c._uU(2,"Dashboard"),c.qZA(),c.qZA(),c.TgZ(3,"div",1),c.TgZ(4,"ion-item"),c.TgZ(5,"ion-button",2),c.NdJ("click",function(){return e.toggleJobs("past")}),c._UZ(6,"ion-icon",3),c.qZA(),c.TgZ(7,"ion-button",2),c.NdJ("click",function(){return e.toggleJobs("calendar")}),c._UZ(8,"ion-icon",4),c.qZA(),c.TgZ(9,"ion-select",5,6),c.NdJ("ionChange",function(){c.CHM(t);const n=c.MAs(10);return e.staffFilterApplied(n.value)}),c.TgZ(11,"ion-select-option",7),c._uU(12,"All"),c.qZA(),c.YNc(13,Ft,2,2,"ion-select-option",8),c.qZA(),c.qZA(),c.YNc(14,he,14,4,"div",9),c.YNc(15,ue,15,8,"div",9),c.TgZ(16,"ion-fab",10),c.TgZ(17,"ion-fab-button",11),c.NdJ("click",function(){return e.presentModal()}),c._UZ(18,"ion-icon",12),c.qZA(),c.qZA(),c.qZA()}2&t&&(c.xp6(13),c.Q6J("ngForOf",e.staff),c.xp6(1),c.Q6J("ngIf","calendar"===e.eventType),c.xp6(1),c.Q6J("ngIf","calendar"!==e.eventType))},directives:[st.W,C.Ie,C.YG,C.gu,C.t9,C.QI,C.n0,o.sg,o.O5,C.IJ,C.W4,C.cJ,C.GO,C.Q$,C.PM,C.VI,C.j9,C.wd,C.jY,C.oz,C.Nd,C.wI,C.Nh,wt,Ut],pipes:[o.uU],styles:["section[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:24px}section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;justify-content:flex-start;margin-bottom:14px}section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:20px;line-height:24px}.component-wrapper[_ngcontent-%COMP%]{border-top:1px solid #cfd8dc}section.unassigned[_ngcontent-%COMP%]   .section-body[_ngcontent-%COMP%]{border-bottom:1px solid #cfd8dc;padding-bottom:24px;margin-bottom:24px;margin-top:0}section.assigned[_ngcontent-%COMP%]   .section-body[_ngcontent-%COMP%], section.unassigned[_ngcontent-%COMP%]   .section-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:327px 327px 327px;grid-gap:48px}.empty[_ngcontent-%COMP%]{font-size:16px;line-height:22px}.actions[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-right:48px}.actions[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{margin-right:0}ul.sorting[_ngcontent-%COMP%]{margin:0;padding:0;list-style-type:none;flex-flow:row nowrap}ul.sorting[_ngcontent-%COMP%], ul.sorting[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center}ul.sorting[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#78909c;margin-right:32px;cursor:pointer}ul.sorting[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#78909c;margin-left:4px;width:18px;height:18px}ul.sorting[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-of-type{margin-right:0}ul.sorting[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:#000}ul.sorting[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#000;margin-left:4px;width:18px;height:18px}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center}.pagination[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#000;cursor:pointer;width:32px;height:32px}.pagination[_ngcontent-%COMP%]   svg.disabled[_ngcontent-%COMP%]{fill:#eee;cursor:default}.pagination[_ngcontent-%COMP%]   svg.prev[_ngcontent-%COMP%]{margin-right:22px}.clickableDay[_ngcontent-%COMP%]{cursor:pointer;transition:.5s;border-radius:50%;padding:2px;height:20px}.clickableDay[_ngcontent-%COMP%]:hover{background:#d1d1d1}.clickableWeek[_ngcontent-%COMP%]{cursor:pointer;transition:.1s}.clickableWeek[_ngcontent-%COMP%]:hover{background:#d1d1d1}.bc-modal[_ngcontent-%COMP%]{--height:50%!important}"],changeDetection:0}),t})()}];let be=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[i.Bz.forChild(fe)],i.Bz]}),t})();var xe=n(5967),me=n(6731);let Ze=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.ez,be,me.k,xe.C,C.Pc,u.UX,D.U8]]}),t})()},6731:(t,e,n)=>{"use strict";n.d(e,{k:()=>g});var o=n(2057),i=n(3738),s=n(3498),c=n(1786),a=n(8535),r=n(5967),d=n(6099),l=n(793);let g=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({providers:[d.o],imports:[[o.ez,i.u5,i.UX,s.Pc,c._h,a.Bz,r.C]]}),t})()},6610:(t,e,n)=>{"use strict";n.d(e,{W:()=>u});var o=n(793),i=n(4402),s=n(230),c=n(3342),a=n(4612),r=n(3738),d=n(3498),l=n(6099),g=n(4694);const p=["*",[["",8,"actions"]]],h=["*",".actions"];let u=(()=>{class t{constructor(t,e,n){this.fb=t,this.modalController=e,this.searchService=n,this.searchSubmit$=new o.vpe,this.searchForm=this.fb.group({searchCtrl:[""]})}get searchCtrl(){return this.searchForm.get("searchCtrl")}presentModal(){this.showModal().subscribe()}search(){this.searchSubmit$.next(this.searchCtrl.value),this.searchService.search$.next(this.searchCtrl.value)}showModal(){return(0,i.D)(this.modalController.create({component:s.x,cssClass:"bc-modal"})).pipe((0,c.b)(t=>this.modal=t),(0,a.b)(t=>(0,i.D)(t.present())))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(r.qu),o.Y36(d.IN),o.Y36(l.o))},t.\u0275cmp=o.Xpm({type:t,selectors:[["bc-admin-header"]],outputs:{searchSubmit$:"searchText"},ngContentSelectors:h,decls:12,vars:2,consts:[[1,"dashboard-header"],[1,"header-wrapper"],[1,"section-title"],[2,"flex","1 0 auto"],[3,"formGroup","submit"],["type","search","inputmode","search","placeholder","What are you looking for?..","label","Search","theme","dark",3,"control","keyup.enter"],["src","/assets/icon/search.svg"],[1,"user-icon",3,"click"],["src","/assets/icon/builder.svg"],[1,"header-actions"]],template:function(t,e){1&t&&(o.F$t(p),o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.Hsn(3),o.qZA(),o._UZ(4,"div",3),o.TgZ(5,"form",4),o.NdJ("submit",function(){return e.search()}),o.TgZ(6,"bc-input",5),o.NdJ("keyup.enter",function(){return e.searchSubmit$.next(e.searchCtrl.value)}),o._UZ(7,"ion-icon",6),o.qZA(),o.qZA(),o.TgZ(8,"div",7),o.NdJ("click",function(){return e.presentModal()}),o._UZ(9,"ion-icon",8),o.qZA(),o.qZA(),o.TgZ(10,"div",9),o.Hsn(11,1),o.qZA(),o.qZA()),2&t&&(o.xp6(5),o.Q6J("formGroup",e.searchForm),o.xp6(1),o.Q6J("control",e.searchCtrl))},directives:[r._Y,r.JL,r.sg,g.am,d.gu],styles:[".dashboard-header[_ngcontent-%COMP%]{padding:20px 126px 20px 48px;min-height:108px;display:flex;flex-flow:column nowrap;justify-content:center}.dashboard-header[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;justify-content:flex-start}.dashboard-header[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{height:50px;width:327px;margin-right:85px}.dashboard-header[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]   bc-input[_ngcontent-%COMP%]{margin-right:85px}.dashboard-header[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:30px;line-height:36px}.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{margin-top:10px}"],changeDetection:0}),t})()},6099:(t,e,n)=>{"use strict";n.d(e,{o:()=>s});var o=n(6215),i=n(793);let s=(()=>{class t{constructor(){this.eventType="",this.search$=new o.X("")}setEventType(t){this.eventType=t}getEventType(){return this.eventType}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})()},7586:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var o=(()=>(function(t){t.DESC="-",t.ASC="+"}(o||(o={})),o))()}}]);